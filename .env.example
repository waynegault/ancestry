# Ancestry app settings
# Sensitive credentials moved to encrypted storage

### Ancestry Automation Configuration Settings

# ================================
# ESSENTIAL CREDENTIALS (REQUIRED)
# ================================
ANCESTRY_USERNAME=your_ancestry_username
ANCESTRY_PASSWORD=your_ancestry_password

# ================================
# TREE AND PROFILE CONFIGURATION
# ================================
# Your primary tree and profile information
MY_TREE_ID=your_tree_id
MY_PROFILE_ID=your_profile_guid
TREE_NAME=Your Family Tree Name
TREE_OWNER_NAME=Your Name

# ================================
# REFERENCE PERSON CONFIGURATION
# ================================
# Person used as reference point for relationship calculations
REFERENCE_PERSON_ID=your_reference_person_id
REFERENCE_PERSON_NAME=Your Reference Person Name

# ================================
# USER SIGNATURE CONFIGURATION
# ================================
# Used in message signatures and AI prompts
USER_NAME=Your Name
USER_LOCATION=Your Location

# ================================
# TESTING CONFIGURATION
# ================================
# Profile ID used for testing operations (protects this profile from deletion)
TESTING_PROFILE_ID=your_testing_profile_guid

# Person ID for testing tree operations (used in API calls)
TESTING_PERSON_TREE_ID=your_testing_person_id

# ================================
# TEST/MOCK VALUES CONFIGURATION
# ================================
# These values are used for testing and fallback scenarios when real values aren't available

# Essential for test framework (used in utils.py comprehensive tests)
TEST_TREE_ID=your_test_tree_id
TEST_OWNER_NAME=Your Test Owner Name
TEST_PROFILE_ID=your_test_profile_guid
TEST_UUID=your_test_uuid_guid
TEST_CSRF_TOKEN=mock_csrf_token_12345678901234567890

# Used for messaging tests
TEST_RECIPIENT_ID=DUMMY-RECIPIENT-ID
TEST_RECIPIENT_USERNAME=DummyRecipient

# ================================
# SYSTEM CONFIGURATION
# ================================

# Application mode (production, development, dry_run, testing)
APP_MODE=dry_run

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=DEBUG

# Selenium settings
CHROME_DRIVER_PATH=C:\Users\YOUR_USERNAME\.cache\selenium\chromedriver\win64\chromedriver-win64\chromedriver.exe
CHROME_BROWSER_PATH=C:\Program Files\Google\Chrome\Application\chrome.exe
CHROME_USER_DATA_DIR=C:\Users\YOUR_USERNAME\AppData\Local\Google\Chrome\chrome_automation_profile
PROFILE_DIR=chrome_automation_profile

# Processing limits (0 = unlimited)
MAX_PAGES=0
MAX_INBOX=5
MAX_PRODUCTIVE_TO_PROCESS=5

# Data refresh thresholds (0 = always refresh)
PERSON_REFRESH_DAYS=14
CONVERSATION_REFRESH_HOURS=24

# ================================
# ENGAGEMENT-BASED MESSAGING TIMING (Phase 4)
# ================================
# Adaptive follow-up timing based on engagement score and last_logged_in activity
# These intervals apply AFTER the minimum message interval has passed

# Engagement score thresholds (0-100 scale)
ENGAGEMENT_HIGH_THRESHOLD=70
ENGAGEMENT_MEDIUM_THRESHOLD=40
ENGAGEMENT_LOW_THRESHOLD=20

# Last login activity thresholds (days)
LOGIN_ACTIVE_THRESHOLD=7
LOGIN_MODERATE_THRESHOLD=30

# Follow-up intervals (days) - applied after minimum interval
# High engagement (score >= 70) + active login (< 7 days)
FOLLOWUP_HIGH_ENGAGEMENT_DAYS=7

# Medium engagement (score 40-69) or moderate login (7-30 days)
FOLLOWUP_MEDIUM_ENGAGEMENT_DAYS=14

# Low engagement (score 20-39) or inactive login (> 30 days)
FOLLOWUP_LOW_ENGAGEMENT_DAYS=21

# No engagement (score < 20) or never logged in
FOLLOWUP_NO_ENGAGEMENT_DAYS=30

# ================================
# STATUS CHANGE DETECTION (Phase 4.2)
# ================================
# Threshold for considering a FamilyTree record "recent" (days)
# Used to detect when someone was recently added to the tree
STATUS_CHANGE_RECENT_DAYS=7

# ================================
# PHASE 5: RESEARCH ASSISTANT FEATURES
# ================================
# Enable/disable Phase 5 enhancements in messages

# Source Citations - Add GEDCOM source citations to messages
# Example: "They are documented in 1881 Scotland Census (birth)."
PHASE5_ENABLE_SOURCE_CITATIONS=true

# Relationship Diagrams - Add ASCII relationship diagrams to messages
# Example: "Wayne → Fraser (father) → James (grandfather)"
PHASE5_ENABLE_RELATIONSHIP_DIAGRAMS=true

# Research Suggestions - Add Ancestry collection suggestions to messages
# Example: "You might find more information in Scotland Birth Records (1855-1875)"
# NOTE: Can be verbose, recommended to keep disabled unless specifically needed
PHASE5_ENABLE_RESEARCH_SUGGESTIONS=false

# DNA Match Processing Configuration
# Number of matches displayed per page by Ancestry (typically 20)
MATCHES_PER_PAGE=20

# ================================
# PERFORMANCE CONFIGURATION
# ================================
# API concurrency settings - Conservative for rate limiting compliance
MAX_CONCURRENCY=2

# Thread Pool Workers - Controls parallel API fetching in Action 6
# VALIDATED: 3 workers proven reliable for sustained batch processing
# PERFORMANCE: 100% throughput increase over 1 worker (safe for parallel processing)
# CAUTION: Higher worker counts require proportionally higher REQUESTS_PER_SECOND
# Formula: 3 workers @ 1.2 RPS total = 0.4 RPS per worker (safe for parallel)
# If you experience "too many 429 error responses", reduce both workers and RPS
THREAD_POOL_WORKERS=3

# MAX_RETRIES used by the retry
MAX_RETRIES=5
# Headlessmode
HEADLESS_MODE=False

# File locations
LOG_DIR=Logs
DATA_DIR=Data
CACHE_DIR=Cache

# Microsoft Graph Integration
MS_GRAPH_CLIENT_ID=your_ms_graph_client_id
MS_GRAPH_TENANT_ID=your_ms_graph_tenant_id
MS_TODO_LIST_NAME=Ancestry

# Rate Limiting Configuration
# REQUESTS_PER_SECOND: Target rate for API requests (NOT Ancestry's documented limit - empirically derived)
# IMPORTANT: Ancestry does NOT publish official API rate limits
#
# Performance Guide (October 2025) - VALIDATED RESULTS:
#   0.4 RPS = ULTRA-CONSERVATIVE (2.5s between requests) - Zero 429 errors but VERY SLOW (26.7 hours for 16K matches)
#   0.6 RPS = CONSERVATIVE OPTIMIZATION (1.67s between requests) - ✅ RECOMMENDED for production (.env default)
#   1.2 RPS = MODERATE (0.83s between requests) - ✅ RECOMMENDED for template - Good balance of speed and safety
#   1.6 RPS = AGGRESSIVE (0.63s between requests) - Test carefully, monitor for 429s
#   2.0+ RPS = DANGER ZONE - High risk of 429 errors and 72-second penalties
#
# Formula: seconds_between_requests = 1 / REQUESTS_PER_SECOND
# Example: 1.2 RPS = 0.83 seconds minimum between requests
#
# ⚠️ IMPORTANT: Must scale with THREAD_POOL_WORKERS
# 3 workers @ 1.2 RPS total = 0.4 RPS per worker (safe for parallel processing)
#
# Performance Impact (16K matches, 20 matches/page = 800 pages):
# - 0.4 RPS: ~26.7 hours for full run (baseline)
# - 0.6 RPS: ~17.8 hours for full run (1.5x faster, conservative optimization)
# - 1.2 RPS: ~12-15 hours for full run (2-2.2x faster, template default)
# - 1.6 RPS: ~10-12 hours for full run (2.5-2.7x faster, aggressive)
#
# ⚠️ VALIDATION REQUIRED: 429 errors trigger 72-second penalties (massive throughput loss)
# Start at 1.2 RPS, monitor for 50-100 pages, then increase if stable
# Conservative optimization: Start at 0.6 RPS with 2 workers for 50% improvement
#
# RECOMMENDED SETTINGS:
# - Production (.env): THREAD_POOL_WORKERS=2, REQUESTS_PER_SECOND=0.6 (conservative optimization)
# - Template (.env.example): THREAD_POOL_WORKERS=3, REQUESTS_PER_SECOND=1.2 (performance optimized)
REQUESTS_PER_SECOND=1.2

# API Cache TTL - Controls how long API responses are cached
# RECOMMENDED: 7200 seconds (2 hours) for better cache utilization in long runs
# IMPACT: Longer TTL increases cache hit rates, reducing API calls by 14-20%
API_CACHE_TTL_SECONDS=7200

INITIAL_DELAY=0.5
MAX_DELAY=45.0
BACKOFF_FACTOR=1.8
TOKEN_BUCKET_CAPACITY=5.0
TOKEN_BUCKET_FILL_RATE=2.0

# DNA Match Processing Configuration
# Minimum cM threshold for fetching detailed relationship probability data
# Matches below this threshold skip detailed API calls for performance
DNA_MATCH_PROBABILITY_THRESHOLD_CM=50

# Database Configuration
DATABASE_FILE=Data/ancestry.db
DB_POOL_SIZE=10

# Files
GEDCOM_FILE_PATH=Data/Gault Family.ged
# include trailing slash
BASE_URL=https://www.ancestry.co.uk/

# ==================================
# AI PROVIDER CONFIGURATION
# ==================================
# AI credentials
# "gemini" for Gemini or "deepseek" for DeepSeek
AI_PROVIDER="deepseek"

# AI settings
DEEPSEEK_AI_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_AI_MODEL=deepseek-chat
DEEPSEEK_API_KEY=your_deepseek_api_key

GOOGLE_AI_BASE_URL=""
GOOGLE_AI_MODEL=gemini-2.0-flash
GOOGLE_API_KEY=your_google_api_key

AI_CONTEXT_MESSAGES_COUNT=7
AI_CONTEXT_MESSAGE_MAX_WORDS=500



# ================================
# ACTION 10 & 11 TEST CASE CONFIGURATION
# ================================
# Configure a specific person for testing Action 10 (search) and Action 11 (family details)
# Change these values to test with different people

# Test Person Basic Details
TEST_PERSON_FIRST_NAME=Test_FirstName
TEST_PERSON_LAST_NAME=Test_LastName
TEST_PERSON_GENDER=M
TEST_PERSON_BIRTH_YEAR=1940
TEST_PERSON_BIRTH_PLACE=Test_BirthPlace
TEST_PERSON_DEATH_YEAR=
TEST_PERSON_DEATH_PLACE=
TEST_PERSON_IS_DECEASED=false

# Test Person Family Details
TEST_PERSON_ID=test_person_id
TEST_PERSON_SPOUSE_NAME=Test Spouse Name
TEST_PERSON_CHILDREN_NAMES=Test Child 1,Test Child 2,Test Child 3
TEST_PERSON_CHILDREN_COUNT=3

# Test Person's Parents
TEST_PERSON_FATHER_NAME=Test Father Name
TEST_PERSON_FATHER_BIRTH_DATE=1 Jan 1900
TEST_PERSON_FATHER_DEATH_DATE=1 Jan 1980
TEST_PERSON_MOTHER_NAME=Test Mother Name
TEST_PERSON_MOTHER_BIRTH_DATE=1 Jan 1905
TEST_PERSON_MOTHER_DEATH_DATE=1 Jan 1990

# Test Person's Siblings
TEST_PERSON_SIBLINGS_NAMES=Test Sibling 1,Test Sibling 2,Test Sibling 3
TEST_PERSON_SIBLINGS_COUNT=3

# Test Person Relationship to Tree Owner
TEST_PERSON_RELATIONSHIP_TO_OWNER=Test Relationship
TEST_PERSON_RELATIONSHIP_PATH="Test relationship path description"
TEST_TREE_OWNER_NAME="Your Name"

# Expected Scoring Results - Based on Real GEDCOM Tests (VERIFIED & FIXED)
TEST_PERSON_EXPECTED_SCORE_COMPREHENSIVE=160
TEST_PERSON_EXPECTED_SCORE_FILTER=145
TEST_PERSON_EXPECTED_FIELD_SCORES_COMPREHENSIVE=givn:25,surn:25,gender:15,byear:20,bplace:20,bbonus:15,ddate:15,bonus:25
TEST_PERSON_EXPECTED_FIELD_SCORES_FILTER=givn:25,surn:25,gender:0,byear:20,bplace:20,bbonus:15,ddate:15,bonus:25

# Scoring Analysis Notes - FIXED
TEST_SCORING_NOTES=Filter test excludes gender (0 pts), Comprehensive includes gender (15 pts). Birth year matching FIXED by adding year_birth weight key. Bonus birth info now working (15 pts).

# Action 10 (Search) Expected Results
TEST_ACTION10_MIN_CONFIDENCE_SCORE=80
TEST_ACTION10_EXPECTED_MATCH_COUNT_MIN=1
TEST_ACTION10_EXPECTED_TOP_MATCH_NAME=Fraser Gault
TEST_ACTION10_BIRTH_YEAR_TOLERANCE=3
TEST_ACTION10_EXPECTED_GENDER_MATCH=true
TEST_ACTION10_EXPECTED_LOCATION_MATCH=true

# Action 11 (Family Details) Expected Results
TEST_ACTION11_EXPECTED_SPOUSE_COUNT=1
TEST_ACTION11_EXPECTED_SPOUSE_NAME=Helen
TEST_ACTION11_EXPECTED_CHILDREN_COUNT=3
TEST_ACTION11_EXPECTED_CHILDREN_NAMES=David Gault,Caroline Gault,Barry Gault
TEST_ACTION11_EXPECTED_PARENTS_PRESENT=true
TEST_ACTION11_EXPECTED_SIBLINGS_PRESENT=false

# Test Validation Settings
TEST_VALIDATE_NAME_SIMILARITY_THRESHOLD=0.8
TEST_VALIDATE_BIRTH_YEAR_RANGE=true
TEST_VALIDATE_FAMILY_RELATIONSHIPS=true
TEST_VALIDATE_SPOUSE_DETAILS=true
TEST_VALIDATE_CHILDREN_DETAILS=true

MAX_DISPLAY_RESULTS=3

# GEDCOM File Configuration
GEDCOM_FILE_PATH=Data/Your_Family_Tree.ged

# ================================
# OBSERVABILITY CONFIGURATION
# ================================
PROMETHEUS_METRICS_ENABLED=false
PROMETHEUS_METRICS_HOST=127.0.0.1
PROMETHEUS_METRICS_PORT=9000
PROMETHEUS_METRICS_NAMESPACE=ancestry
