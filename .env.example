# Ancestry app settings
# Sensitive credentials moved to encrypted storage

### Ancestry Automation Configuration Settings

# ================================
# ESSENTIAL CREDENTIALS (REQUIRED)
# ================================
# ANCESTRY_USERNAME=francesmchardy@gmail.com
# ANCESTRY_PASSWORD=catherine!14
ANCESTRY_USERNAME=waynegault@msn.com
ANCESTRY_PASSWORD=WgAuLT69#!!?

# ================================
# TREE AND PROFILE CONFIGURATION
# ================================
# Your primary tree and profile information
MY_TREE_ID=175946702
MY_PROFILE_ID=07bdd45e-0006-0000-0000-000000000000
TREE_NAME=Gault Family
TREE_OWNER_NAME=Wayne Gordon Gault

# ================================
# REFERENCE PERSON CONFIGURATION
# ================================
# Person used as reference point for relationship calculations
REFERENCE_PERSON_ID=I102281560836
REFERENCE_PERSON_NAME=Wayne Gordon Gault

# ================================
# USER SIGNATURE CONFIGURATION
# ================================
# Used in message signatures and AI prompts
USER_NAME=Wayne
USER_LOCATION=Aberdeen, Scotland

# ================================
# TESTING CONFIGURATION
# ================================
# Profile ID used for testing operations (protects this profile from deletion)
# frances milne
TESTING_PROFILE_ID=08FA6E79-0006-0000-0000-000000000000

# Person ID for testing tree operations (used in API calls)
TESTING_PERSON_TREE_ID=102281560544

# ================================
# TEST/MOCK VALUES CONFIGURATION
# ================================
# These values are used for testing and fallback scenarios when real values aren't available

# Essential for test framework (used in utils.py comprehensive tests)
TEST_TREE_ID=175946702
TEST_OWNER_NAME=Wayne Gordon Gault
TEST_PROFILE_ID=08FA6E79-0006-0000-0000-000000000000
TEST_UUID=07bdd45e-0006-0000-0000-000000000000
TEST_CSRF_TOKEN=mock_csrf_token_12345678901234567890

# Used for messaging tests
TEST_RECIPIENT_ID=DUMMY-RECIPIENT-ID
TEST_RECIPIENT_USERNAME=DummyRecipient

# ================================
# SYSTEM CONFIGURATION
# ================================

# Application mode (production, development, dry_run, testing)
APP_MODE=dry_run

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=DEBUG

# Selenium settings
CHROME_DRIVER_PATH=C:\Users\wayne\.cache\selenium\chromedriver\win64\chromedriver-win64\chromedriver.exe
CHROME_BROWSER_PATH=C:\Program Files\Google\Chrome\Application\chrome.exe
CHROME_USER_DATA_DIR=C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
PROFILE_DIR=chrome_automation_profile

# Processing limits (0 = unlimited)
MAX_PAGES=0
MAX_INBOX=5
MAX_PRODUCTIVE_TO_PROCESS=5

# Data refresh thresholds (0 = always refresh)
PERSON_REFRESH_DAYS=14
CONVERSATION_REFRESH_HOURS=24

# ================================
# ENGAGEMENT-BASED MESSAGING TIMING (Phase 4)
# ================================
# Adaptive follow-up timing based on engagement score and last_logged_in activity
# These intervals apply AFTER the minimum message interval has passed

# Engagement score thresholds (0-100 scale)
ENGAGEMENT_HIGH_THRESHOLD=70
ENGAGEMENT_MEDIUM_THRESHOLD=40
ENGAGEMENT_LOW_THRESHOLD=20

# Last login activity thresholds (days)
LOGIN_ACTIVE_THRESHOLD=7
LOGIN_MODERATE_THRESHOLD=30

# Follow-up intervals (days) - applied after minimum interval
# High engagement (score >= 70) + active login (< 7 days)
FOLLOWUP_HIGH_ENGAGEMENT_DAYS=7

# Medium engagement (score 40-69) or moderate login (7-30 days)
FOLLOWUP_MEDIUM_ENGAGEMENT_DAYS=14

# Low engagement (score 20-39) or inactive login (> 30 days)
FOLLOWUP_LOW_ENGAGEMENT_DAYS=21

# No engagement (score < 20) or never logged in
FOLLOWUP_NO_ENGAGEMENT_DAYS=30

# ================================
# STATUS CHANGE DETECTION (Phase 4.2)
# ================================
# Threshold for considering a FamilyTree record "recent" (days)
# Used to detect when someone was recently added to the tree
STATUS_CHANGE_RECENT_DAYS=7

# DNA Match Processing Configuration
# Number of matches displayed per page by Ancestry (typically 20)
MATCHES_PER_PAGE=20

# ================================
# PERFORMANCE CONFIGURATION
# ================================
# API concurrency settings - Conservative for rate limiting compliance
MAX_CONCURRENCY=2

# Thread Pool Workers - Controls parallel API fetching in Action 6
# VALIDATED: 3 workers proven reliable for sustained batch processing
# PERFORMANCE: 100% throughput increase over 1 worker (safe for parallel processing)
# CAUTION: Higher worker counts require proportionally higher REQUESTS_PER_SECOND
# Formula: 3 workers @ 1.2 RPS total = 0.4 RPS per worker (safe for parallel)
# If you experience "too many 429 error responses", reduce both workers and RPS
THREAD_POOL_WORKERS=3

# MAX_RETRIES used by the retry
MAX_RETRIES=5
# Headlessmode
HEADLESS_MODE=False

# File locations
LOG_DIR=Logs
DATA_DIR=Data
CACHE_DIR=Cache

# Microsoft Graph Integration
MS_GRAPH_CLIENT_ID=ab07d95c-bb7f-4121-b365-0784fa7831e8
MS_GRAPH_TENANT_ID=fa6506d2-27a3-47fb-8051-03562f4b7f49
MS_TODO_LIST_NAME=Ancestry

# Rate Limiting Configuration
# REQUESTS_PER_SECOND: Target rate for API requests (NOT Ancestry's documented limit - empirically derived)
# IMPORTANT: Ancestry does NOT publish official API rate limits
#
# Performance Guide (October 2025) - VALIDATED RESULTS:
#   0.4 RPS = ULTRA-CONSERVATIVE (2.5s between requests) - Zero 429 errors but VERY SLOW (26.7 hours for 16K matches)
#   0.6 RPS = CONSERVATIVE OPTIMIZATION (1.67s between requests) - ✅ RECOMMENDED for production (.env default)
#   1.2 RPS = MODERATE (0.83s between requests) - ✅ RECOMMENDED for template - Good balance of speed and safety
#   1.6 RPS = AGGRESSIVE (0.63s between requests) - Test carefully, monitor for 429s
#   2.0+ RPS = DANGER ZONE - High risk of 429 errors and 72-second penalties
#
# Formula: seconds_between_requests = 1 / REQUESTS_PER_SECOND
# Example: 1.2 RPS = 0.83 seconds minimum between requests
#
# ⚠️ IMPORTANT: Must scale with THREAD_POOL_WORKERS
# 3 workers @ 1.2 RPS total = 0.4 RPS per worker (safe for parallel processing)
#
# Performance Impact (16K matches, 20 matches/page = 800 pages):
# - 0.4 RPS: ~26.7 hours for full run (baseline)
# - 0.6 RPS: ~17.8 hours for full run (1.5x faster, conservative optimization)
# - 1.2 RPS: ~12-15 hours for full run (2-2.2x faster, template default)
# - 1.6 RPS: ~10-12 hours for full run (2.5-2.7x faster, aggressive)
#
# ⚠️ VALIDATION REQUIRED: 429 errors trigger 72-second penalties (massive throughput loss)
# Start at 1.2 RPS, monitor for 50-100 pages, then increase if stable
# Conservative optimization: Start at 0.6 RPS with 2 workers for 50% improvement
#
# RECOMMENDED SETTINGS:
# - Production (.env): THREAD_POOL_WORKERS=2, REQUESTS_PER_SECOND=0.6 (conservative optimization)
# - Template (.env.example): THREAD_POOL_WORKERS=3, REQUESTS_PER_SECOND=1.2 (performance optimized)
REQUESTS_PER_SECOND=1.2

# API Cache TTL - Controls how long API responses are cached
# RECOMMENDED: 7200 seconds (2 hours) for better cache utilization in long runs
# IMPACT: Longer TTL increases cache hit rates, reducing API calls by 14-20%
API_CACHE_TTL_SECONDS=7200

INITIAL_DELAY=0.5
MAX_DELAY=45.0
BACKOFF_FACTOR=1.8
TOKEN_BUCKET_CAPACITY=5.0
TOKEN_BUCKET_FILL_RATE=2.0

# DNA Match Processing Configuration
# Minimum cM threshold for fetching detailed relationship probability data
# Matches below this threshold skip detailed API calls for performance
DNA_MATCH_PROBABILITY_THRESHOLD_CM=50

# Database Configuration
DATABASE_FILE=Data/ancestry.db
DB_POOL_SIZE=10

# Files
GEDCOM_FILE_PATH=Data/Gault Family.ged
# include trailing slash
BASE_URL=https://www.ancestry.co.uk/

# ==================================
# AI PROVIDER CONFIGURATION
# ==================================
# AI credentials
# "gemini" for Gemini or "deepseek" for DeepSeek    
AI_PROVIDER="deepseek"

# AI settings
DEEPSEEK_AI_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_AI_MODEL=deepseek-chat
DEEPSEEK_API_KEY=sk-b555b5de579548da9e1b25cdf646ecf8

GOOGLE_AI_BASE_URL=""
GOOGLE_AI_MODEL=gemini-2.0-flash
GOOGLE_API_KEY=AIzaSyCZoT6x_5edlOf8DeVA6gy16wdVw8SJqCg

AI_CONTEXT_MESSAGES_COUNT=7
AI_CONTEXT_MESSAGE_MAX_WORDS=500



# ================================
# ACTION 10 & 11 TEST CASE CONFIGURATION
# ================================
# Configure a specific person for testing Action 10 (search) and Action 11 (family details)
# Change these values to test with different people

# Test Person Basic Details
TEST_PERSON_FIRST_NAME=Fraser
TEST_PERSON_LAST_NAME=Gault
TEST_PERSON_GENDER=M
TEST_PERSON_BIRTH_YEAR=1941
TEST_PERSON_BIRTH_PLACE=Banff
TEST_PERSON_DEATH_YEAR=
TEST_PERSON_DEATH_PLACE=
TEST_PERSON_IS_DECEASED=false

# Test Person Family Details - Fraser Gault (b. 1941) - EXACT GEDCOM DATA
TEST_PERSON_ID=I102281560744
TEST_PERSON_SPOUSE_NAME=Nellie Mason Smith
TEST_PERSON_CHILDREN_NAMES=David Gault,Caroline Gault,Barry Gault
TEST_PERSON_CHILDREN_COUNT=3

# Fraser Gault's Parents - EXACT GEDCOM DATA
TEST_PERSON_FATHER_NAME=James Gault
TEST_PERSON_FATHER_BIRTH_DATE=26 April 1906
TEST_PERSON_FATHER_DEATH_DATE=16 JULY 1988
TEST_PERSON_MOTHER_NAME="Dolly Clara Alexina Fraser"
TEST_PERSON_MOTHER_BIRTH_DATE=28 April 1908
TEST_PERSON_MOTHER_DEATH_DATE=8 April 2008

# Fraser Gault's Siblings - EXACT GEDCOM DATA (10 total)
TEST_PERSON_SIBLINGS_NAMES=Derrick Wardie Gault (b. 16 MAY 1943),Margaret Milne Gault (b. 19 AUG 1930 d. 28 OCT 2017),Henry Gault (b. 1 April 1939 d. 8 SEP 2021),Evelyn Jane Gault (b. 30 AUG 1949 d. 6 FEB 2025),Sheila Gault (b. 4 OCT 1931 d. 4 SEP 2022),William 'Billy' George Gault (b. 07/05/1947),Alexander Gault (b. 09/04/1937 d. 13th February 2024),James Thomas Gault (b. 16 March 1935 d. 18 August 1996),Helen Gault (b. 20/2/1933),Thomas Gault (b. 1929 d. 1929)
TEST_PERSON_SIBLINGS_COUNT=10

# Test Person Relationship to Tree Owner - EXACT GEDCOM DATA
TEST_PERSON_RELATIONSHIP_TO_OWNER=Uncle
TEST_PERSON_RELATIONSHIP_PATH="Fraser Gault's father is James Gault (1906-1988) - James Gault's son is Derrick Wardie Gault (b. 1943) - Derrick Wardie Gault's son is Wayne Gordon Gault (b. 1969)"
TEST_TREE_OWNER_NAME="Wayne Gordon Gault"

# Expected Scoring Results - Based on Real GEDCOM Tests (VERIFIED & FIXED)
TEST_PERSON_EXPECTED_SCORE_COMPREHENSIVE=160
TEST_PERSON_EXPECTED_SCORE_FILTER=145
TEST_PERSON_EXPECTED_FIELD_SCORES_COMPREHENSIVE=givn:25,surn:25,gender:15,byear:20,bplace:20,bbonus:15,ddate:15,bonus:25
TEST_PERSON_EXPECTED_FIELD_SCORES_FILTER=givn:25,surn:25,gender:0,byear:20,bplace:20,bbonus:15,ddate:15,bonus:25

# Scoring Analysis Notes - FIXED
TEST_SCORING_NOTES=Filter test excludes gender (0 pts), Comprehensive includes gender (15 pts). Birth year matching FIXED by adding year_birth weight key. Bonus birth info now working (15 pts).

# Action 10 (Search) Expected Results
TEST_ACTION10_MIN_CONFIDENCE_SCORE=80
TEST_ACTION10_EXPECTED_MATCH_COUNT_MIN=1
TEST_ACTION10_EXPECTED_TOP_MATCH_NAME=Fraser Gault
TEST_ACTION10_BIRTH_YEAR_TOLERANCE=3
TEST_ACTION10_EXPECTED_GENDER_MATCH=true
TEST_ACTION10_EXPECTED_LOCATION_MATCH=true

# Action 11 (Family Details) Expected Results
TEST_ACTION11_EXPECTED_SPOUSE_COUNT=1
TEST_ACTION11_EXPECTED_SPOUSE_NAME=Helen
TEST_ACTION11_EXPECTED_CHILDREN_COUNT=3
TEST_ACTION11_EXPECTED_CHILDREN_NAMES=David Gault,Caroline Gault,Barry Gault
TEST_ACTION11_EXPECTED_PARENTS_PRESENT=true
TEST_ACTION11_EXPECTED_SIBLINGS_PRESENT=false

# Test Validation Settings
TEST_VALIDATE_NAME_SIMILARITY_THRESHOLD=0.8
TEST_VALIDATE_BIRTH_YEAR_RANGE=true
TEST_VALIDATE_FAMILY_RELATIONSHIPS=true
TEST_VALIDATE_SPOUSE_DETAILS=true
TEST_VALIDATE_CHILDREN_DETAILS=true

MAX_DISPLAY_RESULTS=3

# GEDCOM File Configuration
GEDCOM_FILE_PATH=Data/Gault Family.ged