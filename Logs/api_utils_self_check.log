15:50:11 INF [action11 log_msg_ 731 ] 
                                      [api_utils.py self-check starting...]
15:50:11 INF [action11 log_msg_ 731 ] 
                                      --- Phase 0: Prerequisite Checks ---
15:50:11 INF [action11 log_msg_ 731 ] - BeautifulSoup Import: OK
15:50:11 INF [action11 log_msg_ 731 ] - format_name Import/Callable: OK
15:50:11 INF [action11 log_msg_ 731 ] - ordinal_case Import/Callable: OK
15:50:11 INF [action11 log_msg_ 731 ] - _parse_date Import/Callable: OK
15:50:11 INF [action11 log_msg_ 731 ] - _clean_display_date Import/Callable: OK
15:50:11 INF [action11 log_msg_ 731 ] - Config Check: Essential credentials/URLs/IDs present.
15:50:11 INF [action11 log_msg_ 731 ] 
                                      --- Phase 1: Session Setup & Login ---
15:50:11 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
15:50:11 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
15:50:11 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
15:50:11 DEB [utils    __init__ 1058] SessionManager instance created: ID=122122848
                                      
15:50:11 DEB [utils    ensure_d 1162] Driver not live, attempting start (Action: Self Check Driver)...
15:50:11 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (Self Check Driver) ---
                                      
15:50:11 DEB [utils    _initial 1472] SessionManager ID=122122848 initializing SQLAlchemy Engine/Session...
15:50:11 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
15:50:11 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
15:50:11 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=123412720 for SM ID=122122848
15:50:11 DEB [utils    _initial 1542] Created Session factory for Engine ID=123412720
15:50:11 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
15:50:11 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
15:50:11 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
15:50:11 DEB [utils    _initial 1547] DB tables checked/created successfully.
15:50:11 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
15:50:11 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
15:50:11 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
15:50:11 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
15:50:11 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
15:50:11 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
15:50:11 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
15:50:14 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.53s (attempt 1)
15:50:14 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
15:50:14 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
15:50:14 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
15:50:14 DEB [chromedr init_web 322 ] Browser window minimized.
15:50:14 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
15:50:14 DEB [utils    start_se 1113] WebDriver initialization successful.
15:50:14 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
15:50:14 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
15:50:14 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
15:50:16 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
15:50:18 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
15:50:18 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
15:50:18 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
15:50:18 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
15:50:18 INF [action11 log_msg_ 731 ] - SessionManager Driver Start: PASSED
15:50:18 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: Self Check Ready)
15:50:18 DEB [utils    ensure_d 1159] Driver already live (Action: Self Check Ready - Ensure Driver).
15:50:18 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
15:50:18 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: Self Check Ready - Readiness Checks)...
15:50:18 DEB [utils    login_st 4736] Checking login status (API prioritized)...
15:50:18 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
15:50:18 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
15:50:18 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
15:50:18 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:18 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:18 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
15:50:18 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:18 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:18 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
15:50:18 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.456s (CurrentDelay: 0.50s)
15:50:19 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.46s (Attempt 1)
15:50:19 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-6071aae...85-01', 'tracestate': '2611750@nr...18945', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:50:19 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
15:50:20 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
15:50:20 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:50:20 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
15:50:20 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
15:50:20 DEB [utils    _perform 1362] Checking/Handling current URL...
15:50:20 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
15:50:20 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
15:50:20 DEB [utils    _perform 1368] URL check/handling OK.
15:50:20 DEB [utils    _perform 1371] Verifying essential cookies...
15:50:20 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
15:50:20 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
15:50:20 DEB [utils    _perform 1378] Essential cookies OK.
15:50:20 DEB [utils    _perform 1381] Syncing cookies to requests session...
15:50:20 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:20 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:20 DEB [utils    _perform 1384] Cookies synced.
15:50:20 DEB [utils    _perform 1391] Ensuring CSRF token...
15:50:20 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
15:50:20 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
15:50:20 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
15:50:20 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
15:50:20 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:20 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:20 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
15:50:20 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.511s (CurrentDelay: 0.50s)
15:50:21 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.51s (Attempt 1)
15:50:21 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-380247c...ec-01', 'tracestate': '2611750@nr...20612', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:50:21 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
15:50:21 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
15:50:21 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:50:21 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
15:50:21 DEB [utils    _perform 1400] CSRF token OK.
15:50:21 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
15:50:21 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
15:50:21 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
15:50:21 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
15:50:21 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
15:50:21 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
15:50:21 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:21 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:21 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
15:50:21 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.455s (CurrentDelay: 0.50s)
15:50:22 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.45s (Attempt 1)
15:50:22 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-966d4da...23-01', 'tracestate': '2611750@nr...21665', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:50:22 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
15:50:22 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
15:50:22 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:50:22 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
15:50:22 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
15:50:22 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
15:50:22 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
15:50:22 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
15:50:22 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:22 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:22 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
15:50:22 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.464s (CurrentDelay: 0.50s)
15:50:23 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.46s (Attempt 1)
15:50:23 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-96c92f7...d1-01', 'tracestate': '2611750@nr...22581', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:50:23 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
15:50:23 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
15:50:23 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:50:23 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
15:50:23 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
15:50:23 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
15:50:23 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
15:50:23 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
15:50:23 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:23 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:23 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
15:50:23 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.416s (CurrentDelay: 0.50s)
15:50:23 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.42s (Attempt 1)
15:50:23 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-19d1f81...4e-01', 'tracestate': '2611750@nr...23530', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:50:23 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
15:50:24 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
15:50:24 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:50:24 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
15:50:24 INF [utils    _retriev 1724] My tree id: 175946702
15:50:24 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
15:50:24 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
15:50:24 DEB [utils    _retriev 1759] Retrieving tree owner name...
15:50:24 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
15:50:24 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
15:50:24 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:24 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:24 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
15:50:24 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.484s (CurrentDelay: 0.50s)
15:50:25 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.48s (Attempt 1)
15:50:25 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-7f205aa...33-01', 'tracestate': '2611750@nr...24663', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:50:25 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
15:50:25 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
15:50:25 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:50:25 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
15:50:25 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
15:50:25 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
15:50:25 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
15:50:25 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
15:50:25 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
15:50:25 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
15:50:25 INF [action11 log_msg_ 731 ] - SessionManager Session Ready: PASSED
15:50:25 INF [action11 log_msg_ 731 ] 
                                      --- Phase 2: Get Target Info & Validate Config ---
15:50:25 INF [action11 log_msg_ 731 ] - Target Profile ID (TESTING_PROFILE_ID): 08FA6E79-0006-0000-0000-000000000000
15:50:25 INF [action11 log_msg_ 731 ] - Target Person ID (TESTING_PERSON_TREE_ID): 102281560544
15:50:25 INF [action11 log_msg_ 731 ] - Target Tree ID: 175946702
15:50:25 INF [action11 log_msg_ 731 ] - Target Owner Name: Wayne Gault
15:50:25 INF [action11 log_msg_ 731 ] - Getting target name from: https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000
15:50:25 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
15:50:25 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:25 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:25 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
15:50:25 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.545s (CurrentDelay: 0.50s)
15:50:26 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.55s (Attempt 1)
15:50:26 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-5e878a5...3c-01', 'tracestate': '2611750@nr...25670', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:50:26 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
15:50:26 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
15:50:26 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:50:26 INF [action11 log_msg_ 731 ] - Target Display Name found: 'Frances Mc Hardy'
15:50:26 INF [action11 log_msg_ 731 ] 
                                      --- Phase 3: Test parse_ancestry_person_details (Profile Details API) ---
15:50:26 INF [action11 log_msg_ 731 ] - Using Profile Details API response from Phase 2.
15:50:26 INF [action11 log_msg_ 731 ] - parse_ancestry_person_details call: SUCCESS
15:50:26 INF [action11 log_msg_ 731 ] - Parsed Details Validation: PASSED (Name: 'Frances Mc Hardy', Link: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/08FA6E79-0006-0000-0000-000000000000/facts)
15:50:26 INF [action11 log_msg_ 731 ] 
                                      --- Phase 4: Test Relationship Ladder Parsing (using /getladder) ---
15:50:26 INF [action11 log_msg_ 731 ] - Calling Tree Relationship Ladder API: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746197426829&_=1746197426829
15:50:26 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
15:50:26 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746197426829&_=1746197426829 (Timeout: 20s, AllowRedirects: True)
15:50:26 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:50:26 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:50:26 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
15:50:26 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.430s (CurrentDelay: 0.50s)
15:50:27 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.43s (Attempt 1)
15:50:27 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-416374c...b9-01', 'tracestate': '2611750@nr...26844', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:50:27 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
15:50:28 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
15:50:28 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:50:28 INF [action11 log_msg_ 731 ] - Tree Ladder API call: SUCCESS (Received string)
15:50:28 INF [action11 log_msg_ 731 ] - Extracting HTML using _extract_ladder_html...
15:50:28 INF [action11 log_msg_ 731 ] - HTML Extraction SUCCESS.
15:50:28 INF [action11 log_msg_ 731 ] - Testing display_raw_relationship_ladder...
15:50:28 INF [action11 log_msg_ 731 ] - display_raw_relationship_ladder execution: PASSED (No exceptions)
15:50:28 INF [action11 log_msg_ 731 ] - Testing format_api_relationship_path...
15:50:28 INF [action11 log_msg_ 731 ] - format_api_relationship_path call: PASSED
15:50:28 DEB [action11 log_msg_ 731 ] - Output Preview:
                                      Overall: Mother
                                      Path:
                                      Frances Margaret Milne
                                      -> Frances Margaret Milne is the Father of Wayne Gault...
                                      
15:50:28 INF [action11 log_msg_ 731 ] 
                                      --- Finalizing: Closing Session ---
15:50:28 DEB [utils    close_se 2732] Attempting to close WebDriver session...
15:50:28 DEB [utils    close_se 2735] WebDriver session quit successfully.
15:50:28 DEB [utils    close_se 2754] Closing database connection pool...
15:50:28 DEB [utils    cls_db_c 2185] SessionManager ID=122122848 cls_db_conn called (keep_db=False). Disposing Engine ID: 123412720
15:50:28 DEB [utils    cls_db_c 2190] Engine ID=123412720 disposed successfully.
15:50:28 INF [action11 self_che 960 ] api_utils self-check status: PASS
15:50:28 DEB [cache    close_ca 261 ] Closing DiskCache connection...
15:50:28 DEB [cache    close_ca 263 ] DiskCache connection closed.
15:51:56 INF [api_util log_msg_ 731 ] 
                                      [api_utils.py self-check starting...]
15:51:56 INF [api_util log_msg_ 731 ] 
                                      --- Phase 0: Prerequisite Checks ---
15:51:56 INF [api_util log_msg_ 731 ] - BeautifulSoup Import: OK
15:51:56 INF [api_util log_msg_ 731 ] - format_name Import/Callable: OK
15:51:56 INF [api_util log_msg_ 731 ] - ordinal_case Import/Callable: OK
15:51:56 INF [api_util log_msg_ 731 ] - _parse_date Import/Callable: OK
15:51:56 INF [api_util log_msg_ 731 ] - _clean_display_date Import/Callable: OK
15:51:56 INF [api_util log_msg_ 731 ] - Config Check: Essential credentials/URLs/IDs present.
15:51:56 INF [api_util log_msg_ 731 ] 
                                      --- Phase 1: Session Setup & Login ---
15:51:56 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
15:51:56 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
15:51:56 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
15:51:56 DEB [utils    __init__ 1058] SessionManager instance created: ID=120500784
                                      
15:51:56 DEB [utils    ensure_d 1162] Driver not live, attempting start (Action: Self Check Driver)...
15:51:56 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (Self Check Driver) ---
                                      
15:51:56 DEB [utils    _initial 1472] SessionManager ID=120500784 initializing SQLAlchemy Engine/Session...
15:51:56 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
15:51:56 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
15:51:56 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=123447696 for SM ID=120500784
15:51:56 DEB [utils    _initial 1542] Created Session factory for Engine ID=123447696
15:51:56 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
15:51:56 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
15:51:56 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
15:51:56 DEB [utils    _initial 1547] DB tables checked/created successfully.
15:51:56 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
15:51:56 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
15:51:56 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
15:51:56 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
15:51:56 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
15:51:56 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
15:51:56 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
15:51:59 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.47s (attempt 1)
15:51:59 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
15:51:59 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
15:51:59 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
15:51:59 DEB [chromedr init_web 322 ] Browser window minimized.
15:51:59 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
15:51:59 DEB [utils    start_se 1113] WebDriver initialization successful.
15:51:59 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
15:51:59 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
15:51:59 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
15:52:01 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
15:52:03 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
15:52:03 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
15:52:03 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
15:52:03 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
15:52:03 INF [api_util log_msg_ 731 ] - SessionManager Driver Start: PASSED
15:52:03 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: Self Check Ready)
15:52:03 DEB [utils    ensure_d 1159] Driver already live (Action: Self Check Ready - Ensure Driver).
15:52:03 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
15:52:03 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: Self Check Ready - Readiness Checks)...
15:52:03 DEB [utils    login_st 4736] Checking login status (API prioritized)...
15:52:03 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
15:52:03 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
15:52:03 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
15:52:03 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:03 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:03 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
15:52:03 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:03 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:03 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
15:52:03 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.513s (CurrentDelay: 0.50s)
15:52:04 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.51s (Attempt 1)
15:52:04 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-f33bf73...82-01', 'tracestate': '2611750@nr...23967', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:52:04 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
15:52:05 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
15:52:05 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:52:05 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
15:52:05 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
15:52:05 DEB [utils    _perform 1362] Checking/Handling current URL...
15:52:05 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
15:52:05 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
15:52:05 DEB [utils    _perform 1368] URL check/handling OK.
15:52:05 DEB [utils    _perform 1371] Verifying essential cookies...
15:52:05 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
15:52:05 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
15:52:05 DEB [utils    _perform 1378] Essential cookies OK.
15:52:05 DEB [utils    _perform 1381] Syncing cookies to requests session...
15:52:05 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:05 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:05 DEB [utils    _perform 1384] Cookies synced.
15:52:05 DEB [utils    _perform 1391] Ensuring CSRF token...
15:52:05 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
15:52:05 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
15:52:05 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
15:52:05 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
15:52:05 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:05 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:05 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
15:52:05 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.420s (CurrentDelay: 0.50s)
15:52:06 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.42s (Attempt 1)
15:52:06 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-19032ef...c8-01', 'tracestate': '2611750@nr...25624', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:52:06 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
15:52:06 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
15:52:06 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:52:06 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
15:52:06 DEB [utils    _perform 1400] CSRF token OK.
15:52:06 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
15:52:06 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
15:52:06 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
15:52:06 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
15:52:06 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
15:52:06 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
15:52:06 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:06 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:06 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
15:52:06 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.588s (CurrentDelay: 0.50s)
15:52:07 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.59s (Attempt 1)
15:52:07 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-fb44fe8...ba-01', 'tracestate': '2611750@nr...26500', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
15:52:07 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
15:52:07 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
15:52:07 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:52:07 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
15:52:07 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
15:52:07 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
15:52:07 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
15:52:07 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
15:52:07 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:07 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:07 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
15:52:07 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.549s (CurrentDelay: 0.50s)
15:52:08 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.55s (Attempt 1)
15:52:08 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-3e26dde...61-01', 'tracestate': '2611750@nr...27513', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:52:08 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
15:52:08 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
15:52:08 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:52:08 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
15:52:08 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
15:52:08 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
15:52:08 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
15:52:08 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
15:52:08 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:08 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:08 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
15:52:08 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.464s (CurrentDelay: 0.50s)
15:52:09 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.46s (Attempt 1)
15:52:09 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-3d1e100...57-01', 'tracestate': '2611750@nr...28948', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:52:09 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
15:52:09 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
15:52:09 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:52:09 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
15:52:09 INF [utils    _retriev 1724] My tree id: 175946702
15:52:09 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
15:52:09 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
15:52:09 DEB [utils    _retriev 1759] Retrieving tree owner name...
15:52:09 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
15:52:09 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
15:52:09 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:09 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:09 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
15:52:09 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.541s (CurrentDelay: 0.50s)
15:52:10 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.54s (Attempt 1)
15:52:10 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-90a5ace...cb-01', 'tracestate': '2611750@nr...29957', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:52:10 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
15:52:11 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
15:52:11 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:52:11 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
15:52:11 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
15:52:11 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
15:52:11 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
15:52:11 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
15:52:11 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
15:52:11 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
15:52:11 INF [api_util log_msg_ 731 ] - SessionManager Session Ready: PASSED
15:52:11 INF [api_util log_msg_ 731 ] 
                                      --- Phase 2: Get Target Info & Validate Config ---
15:52:11 INF [api_util log_msg_ 731 ] - Target Profile ID (TESTING_PROFILE_ID): 08FA6E79-0006-0000-0000-000000000000
15:52:11 INF [api_util log_msg_ 731 ] - Target Person ID (TESTING_PERSON_TREE_ID): 102281560544
15:52:11 INF [api_util log_msg_ 731 ] - Target Tree ID: 175946702
15:52:11 INF [api_util log_msg_ 731 ] - Target Owner Name: Wayne Gault
15:52:11 INF [api_util log_msg_ 731 ] - Getting target name from: https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000
15:52:11 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
15:52:11 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:11 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:11 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
15:52:11 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.454s (CurrentDelay: 0.50s)
15:52:11 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.45s (Attempt 1)
15:52:11 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-1fda47f...6c-01', 'tracestate': '2611750@nr...31042', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:52:11 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
15:52:11 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
15:52:11 DEB [utils    _api_req 3294] <-- Response Status: 200 
15:52:11 INF [api_util log_msg_ 731 ] - Target Display Name found: 'Frances Mc Hardy'
15:52:11 INF [api_util log_msg_ 731 ] 
                                      --- Phase 3: Test parse_ancestry_person_details (Profile Details API) ---
15:52:11 INF [api_util log_msg_ 731 ] - Using Profile Details API response from Phase 2.
15:52:11 INF [api_util log_msg_ 731 ] - parse_ancestry_person_details call: SUCCESS
15:52:11 INF [api_util log_msg_ 731 ] - Parsed Details Validation: PASSED (Name: 'Frances Mc Hardy', Link: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/08FA6E79-0006-0000-0000-000000000000/facts)
15:52:11 INF [api_util log_msg_ 731 ] 
                                      --- Phase 4: Test Relationship Ladder Parsing (using /getladder) ---
15:52:11 INF [api_util log_msg_ 731 ] - Calling Tree Relationship Ladder API: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746197531862&_=1746197531862
15:52:11 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
15:52:11 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746197531862&_=1746197531862 (Timeout: 20s, AllowRedirects: True)
15:52:11 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
15:52:11 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
15:52:11 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
15:52:11 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.434s (CurrentDelay: 0.50s)
15:52:12 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.43s (Attempt 1)
15:52:12 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-2e4deb6...cf-01', 'tracestate': '2611750@nr...31878', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
15:52:12 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
15:52:13 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
15:52:13 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
15:52:13 INF [api_util log_msg_ 731 ] - Tree Ladder API call: SUCCESS (Received string)
15:52:13 INF [api_util log_msg_ 731 ] - Extracting HTML using _extract_ladder_html...
15:52:13 INF [api_util log_msg_ 731 ] - HTML Extraction SUCCESS.
15:52:13 INF [api_util log_msg_ 731 ] - Testing display_raw_relationship_ladder...
15:52:13 INF [api_util log_msg_ 731 ] - display_raw_relationship_ladder execution: PASSED (No exceptions)
15:52:13 INF [api_util log_msg_ 731 ] - Testing format_api_relationship_path...
15:52:13 INF [api_util log_msg_ 731 ] - format_api_relationship_path call: PASSED
15:52:13 DEB [api_util log_msg_ 731 ] - Output Preview:
                                      Overall: Mother
                                      Path:
                                      Frances Margaret Milne
                                      -> Frances Margaret Milne is the Father of Wayne Gault...
                                      
15:52:13 INF [api_util log_msg_ 731 ] 
                                      --- Finalizing: Closing Session ---
15:52:13 DEB [utils    close_se 2732] Attempting to close WebDriver session...
15:52:13 DEB [utils    close_se 2735] WebDriver session quit successfully.
15:52:13 DEB [utils    close_se 2754] Closing database connection pool...
15:52:13 DEB [utils    cls_db_c 2185] SessionManager ID=120500784 cls_db_conn called (keep_db=False). Disposing Engine ID: 123447696
15:52:13 DEB [utils    cls_db_c 2190] Engine ID=123447696 disposed successfully.
15:52:13 INF [api_util self_che 960 ] api_utils self-check status: PASS
15:52:13 DEB [cache    close_ca 261 ] Closing DiskCache connection...
15:52:13 DEB [cache    close_ca 263 ] DiskCache connection closed.
16:01:09 INF [api_util log_msg_ 778 ] 
                                      [api_utils.py self-check starting...]
16:01:09 INF [api_util log_msg_ 778 ] 
                                      --- Phase 0: Prerequisite Checks ---
16:01:09 INF [api_util log_msg_ 778 ] - BeautifulSoup Import: OK
16:01:09 INF [api_util log_msg_ 778 ] - format_name Import/Callable: OK
16:01:09 INF [api_util log_msg_ 778 ] - ordinal_case Import/Callable: OK
16:01:09 INF [api_util log_msg_ 778 ] - _parse_date Import/Callable: OK
16:01:09 INF [api_util log_msg_ 778 ] - _clean_display_date Import/Callable: OK
16:01:09 INF [api_util log_msg_ 778 ] - Config Check: Essential credentials/URLs/IDs present.
16:01:09 INF [api_util log_msg_ 778 ] 
                                      --- Phase 1: Session Setup & Login ---
16:01:09 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
16:01:09 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
16:01:09 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
16:01:09 DEB [utils    __init__ 1058] SessionManager instance created: ID=110378784
                                      
16:01:09 DEB [utils    ensure_d 1162] Driver not live, attempting start (Action: Self Check Driver)...
16:01:09 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (Self Check Driver) ---
                                      
16:01:09 DEB [utils    _initial 1472] SessionManager ID=110378784 initializing SQLAlchemy Engine/Session...
16:01:09 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
16:01:09 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
16:01:09 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=123430304 for SM ID=110378784
16:01:09 DEB [utils    _initial 1542] Created Session factory for Engine ID=123430304
16:01:09 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
16:01:09 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
16:01:09 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
16:01:09 DEB [utils    _initial 1547] DB tables checked/created successfully.
16:01:09 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
16:01:09 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
16:01:09 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
16:01:09 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
16:01:09 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
16:01:09 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
16:01:09 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
16:01:12 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.43s (attempt 1)
16:01:12 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
16:01:12 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
16:01:12 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
16:01:12 DEB [chromedr init_web 322 ] Browser window minimized.
16:01:12 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
16:01:12 DEB [utils    start_se 1113] WebDriver initialization successful.
16:01:12 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
16:01:12 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
16:01:12 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
16:01:15 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
16:01:17 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
16:01:17 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
16:01:17 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
16:01:17 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
16:01:17 INF [api_util log_msg_ 778 ] - SessionManager Driver Start: PASSED
16:01:17 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: Self Check Ready)
16:01:17 DEB [utils    ensure_d 1159] Driver already live (Action: Self Check Ready - Ensure Driver).
16:01:17 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
16:01:17 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: Self Check Ready - Readiness Checks)...
16:01:17 DEB [utils    login_st 4736] Checking login status (API prioritized)...
16:01:17 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
16:01:17 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
16:01:17 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
16:01:17 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:17 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:17 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
16:01:17 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:17 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:17 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
16:01:17 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.492s (CurrentDelay: 0.50s)
16:01:17 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.49s (Attempt 1)
16:01:17 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-66e135b...71-01', 'tracestate': '2611750@nr...77371', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:01:17 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
16:01:19 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
16:01:19 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:01:19 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
16:01:19 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
16:01:19 DEB [utils    _perform 1362] Checking/Handling current URL...
16:01:19 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
16:01:19 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
16:01:19 DEB [utils    _perform 1368] URL check/handling OK.
16:01:19 DEB [utils    _perform 1371] Verifying essential cookies...
16:01:19 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:01:19 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:01:19 DEB [utils    _perform 1378] Essential cookies OK.
16:01:19 DEB [utils    _perform 1381] Syncing cookies to requests session...
16:01:19 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:19 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:19 DEB [utils    _perform 1384] Cookies synced.
16:01:19 DEB [utils    _perform 1391] Ensuring CSRF token...
16:01:19 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
16:01:19 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:01:19 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:01:19 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
16:01:19 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:19 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:19 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
16:01:19 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.472s (CurrentDelay: 0.50s)
16:01:19 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.47s (Attempt 1)
16:01:19 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-a80c3e8...2a-01', 'tracestate': '2611750@nr...79108', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:01:19 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
16:01:20 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
16:01:20 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:01:20 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
16:01:20 DEB [utils    _perform 1400] CSRF token OK.
16:01:20 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
16:01:20 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
16:01:20 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
16:01:20 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
16:01:20 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
16:01:20 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
16:01:20 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:20 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:20 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
16:01:20 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.587s (CurrentDelay: 0.50s)
16:01:20 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.59s (Attempt 1)
16:01:20 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-728f453...67-01', 'tracestate': '2611750@nr...80078', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:01:20 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
16:01:21 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
16:01:21 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:01:21 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
16:01:21 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
16:01:21 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
16:01:21 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
16:01:21 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
16:01:21 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:21 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:21 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
16:01:21 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.472s (CurrentDelay: 0.50s)
16:01:21 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.47s (Attempt 1)
16:01:21 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-57edb92...9c-01', 'tracestate': '2611750@nr...81190', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:01:21 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
16:01:22 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
16:01:22 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:01:22 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:01:22 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:01:22 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
16:01:22 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
16:01:22 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
16:01:22 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:22 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:22 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
16:01:22 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.436s (CurrentDelay: 0.50s)
16:01:22 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.44s (Attempt 1)
16:01:22 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-00def0a...7d-01', 'tracestate': '2611750@nr...82319', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:01:22 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
16:01:23 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
16:01:23 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:01:23 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
16:01:23 INF [utils    _retriev 1724] My tree id: 175946702
16:01:23 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
16:01:23 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
16:01:23 DEB [utils    _retriev 1759] Retrieving tree owner name...
16:01:23 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
16:01:23 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
16:01:23 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:23 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:23 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
16:01:23 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.476s (CurrentDelay: 0.50s)
16:01:23 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.48s (Attempt 1)
16:01:23 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-8386d4a...5d-01', 'tracestate': '2611750@nr...83373', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:01:23 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
16:01:24 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
16:01:24 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:01:24 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
16:01:24 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
16:01:24 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
16:01:24 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
16:01:24 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
16:01:24 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
16:01:24 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
16:01:24 INF [api_util log_msg_ 778 ] - SessionManager Session Ready: PASSED
16:01:24 INF [api_util log_msg_ 778 ] 
                                      --- Phase 2: Get Target Info & Validate Config ---
16:01:24 INF [api_util log_msg_ 778 ] - Target Profile ID (TESTING_PROFILE_ID): 08FA6E79-0006-0000-0000-000000000000
16:01:24 INF [api_util log_msg_ 778 ] - Target Person ID (TESTING_PERSON_TREE_ID): 102281560544
16:01:24 INF [api_util log_msg_ 778 ] - Target Tree ID: 175946702
16:01:24 INF [api_util log_msg_ 778 ] - Target Owner Name: Wayne Gault
16:01:24 INF [api_util log_msg_ 778 ] - Getting target name from: https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000
16:01:24 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:01:24 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:24 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:24 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:01:24 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.509s (CurrentDelay: 0.50s)
16:01:24 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.51s (Attempt 1)
16:01:24 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-506fa2f...4d-01', 'tracestate': '2611750@nr...84274', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:01:24 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:01:25 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:01:25 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:01:25 INF [api_util log_msg_ 778 ] - Target Display Name found: 'Frances Mc Hardy'
16:01:25 INF [api_util log_msg_ 778 ] 
                                      --- Phase 3: Test parse_ancestry_person_details (Profile Details API) ---
16:01:25 INF [api_util log_msg_ 778 ] - Using Profile Details API response from Phase 2.
16:01:25 INF [api_util log_msg_ 778 ] - parse_ancestry_person_details call: SUCCESS
16:01:25 INF [api_util log_msg_ 778 ] - Parsed Details Validation: PASSED (Name: 'Frances Mc Hardy', Link: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/08FA6E79-0006-0000-0000-000000000000/facts)
16:01:25 INF [api_util log_msg_ 778 ] 
                                      --- Phase 4: Test Relationship Ladder Parsing (using /getladder) ---
16:01:25 INF [api_util log_msg_ 778 ] - Calling Tree Relationship Ladder API: https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198085446&_=1746198085446
16:01:25 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:01:25 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198085446&_=1746198085446 (Timeout: 20s, AllowRedirects: True)
16:01:25 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:01:25 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:01:25 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:01:25 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.578s (CurrentDelay: 0.50s)
16:01:26 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.58s (Attempt 1)
16:01:26 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-e771198...40-01', 'tracestate': '2611750@nr...85460', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:01:26 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:01:26 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:01:26 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:01:26 INF [api_util log_msg_ 778 ] - Tree Ladder API call: SUCCESS (Received string)
16:01:26 INF [api_util log_msg_ 778 ] - Extracting HTML using _extract_ladder_html...
16:01:26 INF [api_util log_msg_ 778 ] - HTML Extraction SUCCESS.
16:01:26 INF [api_util log_msg_ 778 ] - Testing display_raw_relationship_ladder...
16:01:26 INF [api_util log_msg_ 778 ] - display_raw_relationship_ladder execution: PASSED (No exceptions)
16:01:26 INF [api_util log_msg_ 778 ] - Testing format_api_relationship_path...
16:01:26 INF [api_util log_msg_ 778 ] - format_api_relationship_path call: PASSED
16:01:26 DEB [api_util log_msg_ 778 ] - Output Preview:
                                      Frances Margaret Milne
                                      -> Wayne Gault is the Son of Frances Margaret Milne...
                                      
16:01:26 INF [api_util log_msg_ 778 ] 
                                      --- Finalizing: Closing Session ---
16:01:26 DEB [utils    close_se 2732] Attempting to close WebDriver session...
16:01:26 DEB [utils    close_se 2735] WebDriver session quit successfully.
16:01:26 DEB [utils    close_se 2754] Closing database connection pool...
16:01:26 DEB [utils    cls_db_c 2185] SessionManager ID=110378784 cls_db_conn called (keep_db=False). Disposing Engine ID: 123430304
16:01:26 DEB [utils    cls_db_c 2190] Engine ID=123430304 disposed successfully.
16:01:26 INF [api_util self_che 1007] api_utils self-check status: PASS
16:01:26 DEB [cache    close_ca 261 ] Closing DiskCache connection...
16:01:26 DEB [cache    close_ca 263 ] DiskCache connection closed.
16:05:55 INF [api_util self_che 833 ] 
                                      [api_utils.py self-check starting...]
16:05:55 INF [api_util self_che 836 ] --- Phase 0: Prerequisite Checks ---
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check BeautifulSoup Import
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check BeautifulSoup Import
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Function 'format_name'
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Function 'format_name'
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Function 'ordinal_case'
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Function 'ordinal_case'
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Function '_parse_date'
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Function '_parse_date'
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Function '_clean_display_date'
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Function '_clean_display_date'
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Config Loaded
16:05:55 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Config Loaded
16:05:55 INF [api_util self_che 878 ] --- Phase 1: Session Setup & Login ---
16:05:55 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
16:05:55 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
16:05:55 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
16:05:55 DEB [utils    __init__ 1058] SessionManager instance created: ID=119370720
                                      
16:05:55 DEB [api_util _run_tes 767 ] [ RUNNING SC ] SessionManager.start_sess()
16:05:55 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (SC Phase 1 Start) ---
                                      
16:05:55 DEB [utils    _initial 1472] SessionManager ID=119370720 initializing SQLAlchemy Engine/Session...
16:05:55 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
16:05:55 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
16:05:55 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=123447408 for SM ID=119370720
16:05:55 DEB [utils    _initial 1542] Created Session factory for Engine ID=123447408
16:05:55 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
16:05:55 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
16:05:55 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
16:05:55 DEB [utils    _initial 1547] DB tables checked/created successfully.
16:05:55 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
16:05:56 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
16:05:56 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
16:05:56 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
16:05:56 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
16:05:56 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
16:05:56 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
16:05:58 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.43s (attempt 1)
16:05:58 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
16:05:58 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
16:05:58 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
16:05:58 DEB [chromedr init_web 322 ] Browser window minimized.
16:05:58 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
16:05:58 DEB [utils    start_se 1113] WebDriver initialization successful.
16:05:58 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
16:05:58 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
16:05:58 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
16:06:01 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
16:06:03 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
16:06:03 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
16:06:03 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
16:06:03 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
16:06:03 INF [api_util _run_tes 818 ] [ PASS   SC ] SessionManager.start_sess()
16:06:03 DEB [api_util _run_tes 767 ] [ RUNNING SC ] SessionManager.ensure_session_ready()
16:06:03 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: SC Phase 1 Ready)
16:06:03 DEB [utils    ensure_d 1159] Driver already live (Action: SC Phase 1 Ready - Ensure Driver).
16:06:03 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
16:06:03 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: SC Phase 1 Ready - Readiness Checks)...
16:06:03 DEB [utils    login_st 4736] Checking login status (API prioritized)...
16:06:03 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
16:06:03 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
16:06:03 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
16:06:03 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:03 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:03 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
16:06:03 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:03 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:03 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
16:06:03 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.535s (CurrentDelay: 0.50s)
16:06:03 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.53s (Attempt 1)
16:06:03 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-9121e5f...db-01', 'tracestate': '2611750@nr...63260', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:06:03 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
16:06:04 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
16:06:04 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:04 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
16:06:04 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
16:06:04 DEB [utils    _perform 1362] Checking/Handling current URL...
16:06:04 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
16:06:04 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
16:06:04 DEB [utils    _perform 1368] URL check/handling OK.
16:06:04 DEB [utils    _perform 1371] Verifying essential cookies...
16:06:04 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:06:04 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:06:04 DEB [utils    _perform 1378] Essential cookies OK.
16:06:04 DEB [utils    _perform 1381] Syncing cookies to requests session...
16:06:04 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:04 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:04 DEB [utils    _perform 1384] Cookies synced.
16:06:04 DEB [utils    _perform 1391] Ensuring CSRF token...
16:06:04 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
16:06:04 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:06:04 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:06:04 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
16:06:04 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:04 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:04 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
16:06:04 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.424s (CurrentDelay: 0.50s)
16:06:05 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.42s (Attempt 1)
16:06:05 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-224beb1...4b-01', 'tracestate': '2611750@nr...64766', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:06:05 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
16:06:05 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
16:06:05 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:06:05 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
16:06:05 DEB [utils    _perform 1400] CSRF token OK.
16:06:05 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
16:06:05 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
16:06:05 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
16:06:05 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
16:06:05 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
16:06:05 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
16:06:05 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:05 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:05 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
16:06:05 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.423s (CurrentDelay: 0.50s)
16:06:06 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.42s (Attempt 1)
16:06:06 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-758356d...91-01', 'tracestate': '2611750@nr...65598', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:06:06 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
16:06:06 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
16:06:06 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:06:06 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
16:06:06 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
16:06:06 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
16:06:06 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
16:06:06 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
16:06:06 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:06 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:06 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
16:06:06 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.470s (CurrentDelay: 0.50s)
16:06:06 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.47s (Attempt 1)
16:06:06 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-251f0d6...8d-01', 'tracestate': '2611750@nr...66416', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:06 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
16:06:07 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
16:06:07 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:07 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:06:07 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:06:07 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
16:06:07 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
16:06:07 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
16:06:07 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:07 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:07 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
16:06:07 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.451s (CurrentDelay: 0.50s)
16:06:07 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.45s (Attempt 1)
16:06:07 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-4fb35f0...02-01', 'tracestate': '2611750@nr...67472', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:07 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
16:06:08 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
16:06:08 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:08 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
16:06:08 INF [utils    _retriev 1724] My tree id: 175946702
16:06:08 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
16:06:08 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
16:06:08 DEB [utils    _retriev 1759] Retrieving tree owner name...
16:06:08 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
16:06:08 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
16:06:08 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:08 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:08 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
16:06:08 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.480s (CurrentDelay: 0.50s)
16:06:08 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.48s (Attempt 1)
16:06:08 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-9683fc5...fa-01', 'tracestate': '2611750@nr...68457', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:08 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
16:06:09 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
16:06:09 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:09 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
16:06:09 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
16:06:09 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
16:06:09 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
16:06:09 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
16:06:09 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
16:06:09 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
16:06:09 INF [api_util _run_tes 818 ] [ PASS   SC ] SessionManager.ensure_session_ready()
16:06:09 INF [api_util self_che 901 ] --- Phase 2: Get Target Info & Validate Config ---
16:06:09 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Target Tree ID Found
16:06:09 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Target Tree ID Found
16:06:09 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Target Owner Name Found
16:06:09 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Target Owner Name Found
16:06:09 DEB [api_util _run_tes 767 ] [ RUNNING SC ] API Call: Get Target Name
16:06:09 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:06:09 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:09 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:09 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:06:09 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.532s (CurrentDelay: 0.50s)
16:06:09 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.53s (Attempt 1)
16:06:09 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-1a66e07...bd-01', 'tracestate': '2611750@nr...69362', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:09 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:06:10 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:06:10 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:10 INF [api_util _run_tes 818 ] [ PASS   SC ] API Call: Get Target Name
16:06:10 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:06:10 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:10 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:10 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:06:10 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.530s (CurrentDelay: 0.50s)
16:06:10 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.53s (Attempt 1)
16:06:10 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-37ffcf1...da-01', 'tracestate': '2611750@nr...70249', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:10 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:06:11 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:06:11 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Check Target Name Found in API Resp
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] Check Target Name Found in API Resp
16:06:11 INF [api_util self_che 967 ] --- Phase 3: Test parse_ancestry_person_details ---
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Function Call: parse_ancestry_person_details()
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] Function Call: parse_ancestry_person_details()
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Validation: Parsed Details Keys
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] Validation: Parsed Details Keys
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Validation: Parsed Name Match
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] Validation: Parsed Name Match
16:06:11 INF [api_util self_che 1035] --- Phase 4: Test HTML Extraction ---
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: Good JSONP
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: Good JSONP
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: Bad JSON in JSONP
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: Bad JSON in JSONP
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: No HTML Key in JSONP
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: No HTML Key in JSONP
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: Good Direct JSON
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: Good Direct JSON
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: Bad Direct JSON
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: Bad Direct JSON
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] HTML Extract: Invalid Input
16:06:11 INF [api_util _run_tes 818 ] [ PASS   SC ] HTML Extract: Invalid Input
16:06:11 INF [api_util self_che 1093] --- Phase 5: Test Relationship Ladder Parsing (Live API) ---
16:06:11 DEB [api_util _run_tes 767 ] [ RUNNING SC ] API Call: Get Tree Ladder
16:06:11 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:06:11 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198371103&_=1746198371103 (Timeout: 20s, AllowRedirects: True)
16:06:11 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:11 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:11 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:06:11 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.479s (CurrentDelay: 0.50s)
16:06:11 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.48s (Attempt 1)
16:06:11 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-7ef3935...1c-01', 'tracestate': '2611750@nr...71118', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:11 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:06:12 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:06:12 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:06:12 INF [api_util _run_tes 818 ] [ PASS   SC ] API Call: Get Tree Ladder
16:06:12 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:06:12 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198371103&_=1746198371103 (Timeout: 20s, AllowRedirects: True)
16:06:12 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:06:12 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:06:12 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:06:12 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.526s (CurrentDelay: 0.50s)
16:06:12 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.53s (Attempt 1)
16:06:12 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-4596c5a...31-01', 'tracestate': '2611750@nr...72452', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:06:12 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:06:13 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:06:13 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:06:13 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Function Call: display_raw_relationship_ladder()
16:06:13 INF [api_util _run_tes 818 ] [ PASS   SC ] Function Call: display_raw_relationship_ladder()
16:06:13 DEB [api_util _run_tes 767 ] [ RUNNING SC ] Function Call: format_api_relationship_path()
16:06:13 INF [api_util _run_tes 818 ] [ PASS   SC ] Function Call: format_api_relationship_path()
16:06:13 INF [api_util self_che 1238] --- Finalizing: Closing Session ---
16:06:13 DEB [utils    close_se 2732] Attempting to close WebDriver session...
16:06:13 DEB [utils    close_se 2735] WebDriver session quit successfully.
16:06:13 DEB [utils    close_se 2754] Closing database connection pool...
16:06:13 DEB [utils    cls_db_c 2185] SessionManager ID=119370720 cls_db_conn called (keep_db=False). Disposing Engine ID: 123447408
16:06:13 DEB [utils    cls_db_c 2190] Engine ID=123447408 disposed successfully.
16:06:13 INF [api_util self_che 1270] api_utils self-check overall status: PASS
16:06:13 DEB [cache    close_ca 261 ] Closing DiskCache connection...
16:06:13 DEB [cache    close_ca 263 ] DiskCache connection closed.
16:10:14 INF [api_util self_che 846 ] 
                                      [api_utils.py self-check starting...]
16:10:14 INF [api_util self_che 849 ] --- Phase 0: Prerequisite Checks ---
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check BeautifulSoup Import
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check BeautifulSoup Import
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function 'format_name'
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function 'format_name'
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function 'ordinal_case'
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function 'ordinal_case'
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function '_parse_date'
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function '_parse_date'
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function '_clean_display_date'
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function '_clean_display_date'
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Config Loaded
16:10:14 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Config Loaded
16:10:14 INF [api_util self_che 892 ] --- Phase 1: Session Setup & Login ---
16:10:14 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
16:10:14 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
16:10:14 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
16:10:14 DEB [utils    __init__ 1058] SessionManager instance created: ID=117094064
                                      
16:10:14 DEB [api_util _run_tes 765 ] [ RUNNING SC ] SessionManager.start_sess()
16:10:14 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (SC Phase 1 Start) ---
                                      
16:10:14 DEB [utils    _initial 1472] SessionManager ID=117094064 initializing SQLAlchemy Engine/Session...
16:10:14 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
16:10:14 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
16:10:14 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=117361696 for SM ID=117094064
16:10:14 DEB [utils    _initial 1542] Created Session factory for Engine ID=117361696
16:10:14 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
16:10:14 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
16:10:14 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
16:10:14 DEB [utils    _initial 1547] DB tables checked/created successfully.
16:10:14 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
16:10:15 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
16:10:15 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
16:10:15 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
16:10:15 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
16:10:15 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
16:10:15 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
16:10:17 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.44s (attempt 1)
16:10:17 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
16:10:17 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
16:10:17 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
16:10:17 DEB [chromedr init_web 322 ] Browser window minimized.
16:10:17 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
16:10:17 DEB [utils    start_se 1113] WebDriver initialization successful.
16:10:17 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
16:10:17 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
16:10:17 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
16:10:20 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
16:10:22 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
16:10:22 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
16:10:22 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
16:10:22 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
16:10:22 INF [api_util _run_tes 816 ] [ PASS   SC ] SessionManager.start_sess()
16:10:22 DEB [api_util _run_tes 765 ] [ RUNNING SC ] SessionManager.ensure_session_ready()
16:10:22 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: SC Phase 1 Ready)
16:10:22 DEB [utils    ensure_d 1159] Driver already live (Action: SC Phase 1 Ready - Ensure Driver).
16:10:22 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
16:10:22 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: SC Phase 1 Ready - Readiness Checks)...
16:10:22 DEB [utils    login_st 4736] Checking login status (API prioritized)...
16:10:22 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
16:10:22 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
16:10:22 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
16:10:22 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:22 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:22 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
16:10:22 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:22 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:22 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
16:10:22 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.527s (CurrentDelay: 0.50s)
16:10:23 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.53s (Attempt 1)
16:10:23 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-4787d21...3c-01', 'tracestate': '2611750@nr...22544', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:10:23 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
16:10:23 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
16:10:23 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:23 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
16:10:23 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
16:10:23 DEB [utils    _perform 1362] Checking/Handling current URL...
16:10:23 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
16:10:23 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
16:10:23 DEB [utils    _perform 1368] URL check/handling OK.
16:10:23 DEB [utils    _perform 1371] Verifying essential cookies...
16:10:23 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:10:23 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:10:23 DEB [utils    _perform 1378] Essential cookies OK.
16:10:23 DEB [utils    _perform 1381] Syncing cookies to requests session...
16:10:23 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:23 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:23 DEB [utils    _perform 1384] Cookies synced.
16:10:23 DEB [utils    _perform 1391] Ensuring CSRF token...
16:10:23 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
16:10:23 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:10:23 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:10:23 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
16:10:23 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:23 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:23 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
16:10:23 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.584s (CurrentDelay: 0.50s)
16:10:24 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.58s (Attempt 1)
16:10:24 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-17a88df...47-01', 'tracestate': '2611750@nr...23979', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:10:24 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
16:10:24 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
16:10:24 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:10:24 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
16:10:24 DEB [utils    _perform 1400] CSRF token OK.
16:10:24 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
16:10:24 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
16:10:24 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
16:10:24 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
16:10:24 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
16:10:24 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
16:10:24 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:24 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:24 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
16:10:24 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.599s (CurrentDelay: 0.50s)
16:10:25 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.60s (Attempt 1)
16:10:25 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-f17c2dd...de-01', 'tracestate': '2611750@nr...24855', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:10:25 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
16:10:25 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
16:10:25 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:10:25 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
16:10:25 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
16:10:25 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
16:10:25 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
16:10:25 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
16:10:25 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:25 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:25 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
16:10:25 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.497s (CurrentDelay: 0.50s)
16:10:26 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.50s (Attempt 1)
16:10:26 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-c9f78c7...d5-01', 'tracestate': '2611750@nr...25758', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:26 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
16:10:26 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
16:10:26 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:26 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:10:26 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:10:26 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
16:10:26 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
16:10:26 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
16:10:26 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:26 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:26 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
16:10:26 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.485s (CurrentDelay: 0.50s)
16:10:27 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.48s (Attempt 1)
16:10:27 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-e702fec...17-01', 'tracestate': '2611750@nr...26774', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:27 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
16:10:28 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
16:10:28 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:28 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
16:10:28 INF [utils    _retriev 1724] My tree id: 175946702
16:10:28 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
16:10:28 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
16:10:28 DEB [utils    _retriev 1759] Retrieving tree owner name...
16:10:28 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
16:10:28 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
16:10:28 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:28 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:28 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
16:10:28 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.600s (CurrentDelay: 0.50s)
16:10:28 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.60s (Attempt 1)
16:10:28 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-1db4a8f...09-01', 'tracestate': '2611750@nr...28085', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:28 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
16:10:29 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
16:10:29 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:29 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
16:10:29 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
16:10:29 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
16:10:29 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
16:10:29 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
16:10:29 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
16:10:29 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
16:10:29 INF [api_util _run_tes 816 ] [ PASS   SC ] SessionManager.ensure_session_ready()
16:10:29 INF [api_util self_che 915 ] --- Phase 2: Get Target Info & Validate Config ---
16:10:29 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Tree ID Found
16:10:29 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Tree ID Found
16:10:29 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Owner Name Found
16:10:29 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Owner Name Found
16:10:29 DEB [api_util _run_tes 765 ] [ RUNNING SC ] API Call: Get Target Name
16:10:29 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:10:29 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:29 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:29 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:10:29 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.499s (CurrentDelay: 0.50s)
16:10:29 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.50s (Attempt 1)
16:10:29 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-a0f69e7...bb-01', 'tracestate': '2611750@nr...29092', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:29 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:10:30 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:10:30 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:30 INF [api_util _run_tes 816 ] [ PASS   SC ] API Call: Get Target Name
16:10:30 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:10:30 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:30 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:30 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:10:30 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.409s (CurrentDelay: 0.50s)
16:10:30 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.41s (Attempt 1)
16:10:30 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-31563e2...c5-01', 'tracestate': '2611750@nr...30197', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:30 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:10:31 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:10:31 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Name Found in API Resp
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Name Found in API Resp
16:10:31 INF [api_util self_che 978 ] --- Phase 3: Test parse_ancestry_person_details ---
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: parse_ancestry_person_details()
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: parse_ancestry_person_details()
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Validation: Parsed Details Keys
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] Validation: Parsed Details Keys
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Validation: Parsed Name Match
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] Validation: Parsed Name Match
16:10:31 INF [api_util self_che 1058] --- Phase 4: Test HTML Extraction ---
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Good JSONP
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Good JSONP
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Bad JSON in JSONP
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Bad JSON in JSONP
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: No HTML Key in JSONP
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: No HTML Key in JSONP
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Good Direct JSON
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Good Direct JSON
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Bad Direct JSON
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Bad Direct JSON
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Invalid Input
16:10:31 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Invalid Input
16:10:31 INF [api_util self_che 1118] --- Phase 5: Test Relationship Ladder Parsing (Live API) ---
16:10:31 DEB [api_util _run_tes 765 ] [ RUNNING SC ] API Call: Get Tree Ladder
16:10:31 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:10:31 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198631116&_=1746198631116 (Timeout: 20s, AllowRedirects: True)
16:10:31 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:31 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:31 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:10:31 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.425s (CurrentDelay: 0.50s)
16:10:31 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.43s (Attempt 1)
16:10:31 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-773b2f8...aa-01', 'tracestate': '2611750@nr...31130', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:31 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:10:32 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:10:32 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:10:32 INF [api_util _run_tes 816 ] [ PASS   SC ] API Call: Get Tree Ladder
16:10:32 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:10:32 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198631116&_=1746198631116 (Timeout: 20s, AllowRedirects: True)
16:10:32 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:10:32 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:10:32 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:10:32 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.429s (CurrentDelay: 0.50s)
16:10:32 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.43s (Attempt 1)
16:10:32 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-36cd73e...23-01', 'tracestate': '2611750@nr...32368', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:10:32 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:10:33 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:10:33 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:10:33 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: display_raw_relationship_ladder()
16:10:33 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: display_raw_relationship_ladder()
16:10:33 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: format_api_relationship_path()
16:10:33 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: format_api_relationship_path()
16:10:33 INF [api_util self_che 1263] --- Finalizing: Closing Session ---
16:10:33 DEB [utils    close_se 2732] Attempting to close WebDriver session...
16:10:33 DEB [utils    close_se 2735] WebDriver session quit successfully.
16:10:33 DEB [utils    close_se 2754] Closing database connection pool...
16:10:33 DEB [utils    cls_db_c 2185] SessionManager ID=117094064 cls_db_conn called (keep_db=False). Disposing Engine ID: 117361696
16:10:33 DEB [utils    cls_db_c 2190] Engine ID=117361696 disposed successfully.
16:10:33 INF [api_util self_che 1300] api_utils self-check overall status: PASS
16:10:33 DEB [cache    close_ca 261 ] Closing DiskCache connection...
16:10:33 DEB [cache    close_ca 263 ] DiskCache connection closed.
16:10:53 INF [api_util self_che 846 ] 
                                      [api_utils.py self-check starting...]
16:10:53 INF [api_util self_che 849 ] --- Phase 0: Prerequisite Checks ---
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check BeautifulSoup Import
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check BeautifulSoup Import
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function 'format_name'
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function 'format_name'
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function 'ordinal_case'
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function 'ordinal_case'
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function '_parse_date'
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function '_parse_date'
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Function '_clean_display_date'
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Function '_clean_display_date'
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Config Loaded
16:10:53 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Config Loaded
16:10:53 INF [api_util self_che 892 ] --- Phase 1: Session Setup & Login ---
16:10:53 DEB [utils    __init__ 1017] Initialized shared requests.Session with HTTPAdapter.
16:10:53 DEB [utils    __init__ 1040] Initialized shared cloudscraper instance with retry strategy.
16:10:53 DEB [utils    __init__ 813 ] RateLimiter Init: Capacity=10.0, FillRate=2.0/s, InitialDelay=0.50s, MaxDelay=60.0s, Backoff=1.80, Decrease=0.98
16:10:53 DEB [utils    __init__ 1058] SessionManager instance created: ID=117731936
                                      
16:10:53 DEB [api_util _run_tes 765 ] [ RUNNING SC ] SessionManager.start_sess()
16:10:53 DEB [utils    start_se 1070] --- SessionManager Phase 1: Starting Driver (SC Phase 1 Start) ---
                                      
16:10:53 DEB [utils    _initial 1472] SessionManager ID=117731936 initializing SQLAlchemy Engine/Session...
16:10:53 DEB [utils    _initial 1490] DB Path: C:\Users\wayne\GitHub\Python\Projects\Ancestry\Data\ancestry.db
16:10:53 DEB [utils    _initial 1503] DB Pool Config: Size=10, MaxOverflow=5, Timeout=30
16:10:53 DEB [utils    _initial 1518] Created NEW SQLAlchemy engine: ID=115414208 for SM ID=117731936
16:10:53 DEB [utils    _initial 1542] Created Session factory for Engine ID=115414208
16:10:53 DEB [utils    enable_s 1532] SQLite PRAGMA settings applied (WAL, Foreign Keys, Sync Normal).
16:10:53 DEB [database _create_ 528 ] Executing CREATE VIEW statement for 'messages' view...
16:10:53 DEB [database _create_ 531 ] Database view 'messages' created or already exists.
16:10:53 DEB [utils    _initial 1547] DB tables checked/created successfully.
16:10:53 DEB [utils    start_se 1103] Initializing WebDriver instance (using init_webdvr)...
16:10:53 DEB [chromedr init_web 181 ] WebDriver initialization attempt 1/3...
16:10:53 INF [chromedr init_web 198 ] User data directory (no --profile-directory):
                                      C:\Users\wayne\AppData\Local\Google\Chrome\chrome_automation_profile
16:10:53 DEB [chromedr init_web 211 ] Using browser executable:
                                      C:\Program Files\Google\Chrome\Application\chrome.exe
16:10:53 DEB [chromedr init_web 228 ] Setting User-Agent:
                                      Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
16:10:53 DEB [chromedr init_web 237 ] Letting undetected_chromedriver auto-manage ChromeDriver version (self-patching mode).
16:10:53 INF [chromedr init_web 241 ] [init_webdvr] Attempting uc.Chrome() self-patching (attempt 1)...
16:10:55 INF [chromedr init_web 246 ] [init_webdvr] uc.Chrome() self-patching succeeded in 2.42s (attempt 1)
16:10:55 DEB [chromedr init_web 249 ] WebDriver instance object potentially created (attempt 1).
16:10:55 DEB [chromedr init_web 314 ] User-Agent override applied via CDP.
16:10:55 DEB [chromedr init_web 319 ] Attempting to minimize window (non-headless mode)...
16:10:55 DEB [chromedr init_web 322 ] Browser window minimized.
16:10:55 DEB [chromedr init_web 346 ] WebDriver instance fully configured successfully (attempt 1).
16:10:55 DEB [utils    start_se 1113] WebDriver initialization successful.
16:10:55 DEB [utils    start_se 1115] Navigating to Base URL (https://www.ancestry.co.uk/) to stabilize...
16:10:55 DEB [utils    nav_to_p 4921] Navigation Attempt 1/3 to: https://www.ancestry.co.uk/
16:10:55 DEB [utils    nav_to_p 4952] Executing driver.get('https://www.ancestry.co.uk/')...
16:10:59 DEB [utils    nav_to_p 4977] Landed on URL base: https://www.ancestry.co.uk
16:11:01 DEB [utils    nav_to_p 5106] On correct URL base. Waiting up to 20s for selector: 'body'
16:11:01 DEB [utils    nav_to_p 5113] Navigation successful and element 'body' found on: https://www.ancestry.co.uk/
16:11:01 DEB [utils    start_se 1128] Initial navigation to Base URL successful.
16:11:01 DEB [utils    start_se 1135] --- SessionManager Phase 1: Driver Start Successful ---
16:11:01 INF [api_util _run_tes 816 ] [ PASS   SC ] SessionManager.start_sess()
16:11:01 DEB [api_util _run_tes 765 ] [ RUNNING SC ] SessionManager.ensure_session_ready()
16:11:01 DEB [utils    ensure_s 1181] TRACE: Entered ensure_session_ready (Action: SC Phase 1 Ready)
16:11:01 DEB [utils    ensure_d 1159] Driver already live (Action: SC Phase 1 Ready - Ensure Driver).
16:11:01 DEB [utils    ensure_s 1197] TRACE: Calling _perform_readiness_checks
16:11:01 DEB [utils    _perform 1264] Performing readiness checks (Attempt 1/2, Action: SC Phase 1 Ready - Readiness Checks)...
16:11:01 DEB [utils    login_st 4736] Checking login status (API prioritized)...
16:11:01 DEB [utils    login_st 4751] Attempting API login verification (_verify_api_login_status)...
16:11:01 DEB [utils    _verify_ 2506] Verifying login status via API endpoint: https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna...
16:11:01 DEB [utils    _verify_ 2516] Syncing cookies before API login check...
16:11:01 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:01 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:01 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 15s, AllowRedirects: True)
16:11:01 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:01 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:01 DEB [utils    _api_req 3219] [API Login Verification (header/dna)] Cookies synced (Attempt 1).
16:11:01 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.578s (CurrentDelay: 0.50s)
16:11:01 DEB [utils    _api_req 3244] [API Login Verification (header/dna)] Rate limit wait: 0.58s (Attempt 1)
16:11:01 DEB [utils    _api_req 3265] [_api_req Attempt 1 'API Login Verification (header/dna)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-cce2834...04-01', 'tracestate': '2611750@nr...61211', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:11:01 DEB [utils    _api_req 3274] [_api_req Attempt 1 'API Login Verification (header/dna)'] >>> Calling requests.request...
16:11:02 DEB [utils    _api_req 3288] [_api_req Attempt 1 'API Login Verification (header/dna)'] <<< requests.request returned.
16:11:02 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:02 DEB [utils    _verify_ 2559] API Login Verification (header/dna): API login check successful ('testId' found).
16:11:02 DEB [utils    login_st 4755] Login status confirmed TRUE via API check.
16:11:02 DEB [utils    _perform 1362] Checking/Handling current URL...
16:11:02 DEB [utils    _check_a 1582] Current URL for check: https://www.ancestry.co.uk/
16:11:02 DEB [utils    _check_a 1665] Current URL is suitable, no extra navigation needed.
16:11:02 DEB [utils    _perform 1368] URL check/handling OK.
16:11:02 DEB [utils    _perform 1371] Verifying essential cookies...
16:11:02 DEB [utils    get_cook 1849] Waiting up to 5s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:11:02 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:11:02 DEB [utils    _perform 1378] Essential cookies OK.
16:11:02 DEB [utils    _perform 1381] Syncing cookies to requests session...
16:11:02 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:02 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:02 DEB [utils    _perform 1384] Cookies synced.
16:11:02 DEB [utils    _perform 1391] Ensuring CSRF token...
16:11:02 DEB [utils    get_csrf 1787] Attempting to fetch fresh CSRF token from: https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken
16:11:02 DEB [utils    get_cook 1849] Waiting up to 10s for cookies: ['ANCSESSIONID', 'SecureATT']...
16:11:02 DEB [utils    get_cook 1870] All required cookies found: ['ANCSESSIONID', 'SecureATT'].
16:11:02 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/discoveryui-matches/parents/api/csrfToken (Timeout: 60s, AllowRedirects: True)
16:11:02 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:02 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:02 DEB [utils    _api_req 3219] [CSRF Token API] Cookies synced (Attempt 1).
16:11:02 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.517s (CurrentDelay: 0.50s)
16:11:03 DEB [utils    _api_req 3244] [CSRF Token API] Rate limit wait: 0.52s (Attempt 1)
16:11:03 DEB [utils    _api_req 3265] [_api_req Attempt 1 'CSRF Token API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-f825a8e...7f-01', 'tracestate': '2611750@nr...62738', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:11:03 DEB [utils    _api_req 3274] [_api_req Attempt 1 'CSRF Token API'] >>> Calling requests.request...
16:11:03 DEB [utils    _api_req 3288] [_api_req Attempt 1 'CSRF Token API'] <<< requests.request returned.
16:11:03 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:11:03 DEB [utils    get_csrf 1811] CSRF token successfully retrieved (Length: 144).
16:11:03 DEB [utils    _perform 1400] CSRF token OK.
16:11:03 INF [utils    _perform 1403] Readiness checks PASSED on attempt 1.
16:11:03 DEB [utils    ensure_s 1201] TRACE: _perform_readiness_checks returned: True
16:11:03 DEB [utils    _retriev 1673] TRACE: Entered _retrieve_identifiers
16:11:03 DEB [utils    _retriev 1682] Retrieving profile ID (ucdmid)...
16:11:03 DEB [utils    get_my_p 2211] Attempting to fetch own profile ID (ucdmid)...
16:11:03 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/cdp-p13n/api/v1/users/me?attributes=ucdmid (Timeout: 60s, AllowRedirects: True)
16:11:03 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:03 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:03 DEB [utils    _api_req 3219] [Get my profile_id] Cookies synced (Attempt 1).
16:11:03 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.469s (CurrentDelay: 0.50s)
16:11:04 DEB [utils    _api_req 3244] [Get my profile_id] Rate limit wait: 0.47s (Attempt 1)
16:11:04 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get my profile_id'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'p13n-js', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-9e91724...c0-01', 'tracestate': '2611750@nr...63592', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9'}
16:11:04 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get my profile_id'] >>> Calling requests.request...
16:11:04 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get my profile_id'] <<< requests.request returned.
16:11:04 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:11:04 DEB [utils    get_my_p 2234] Successfully retrieved profile_id: 07BDD45E-0006-0000-0000-000000000000
16:11:04 INF [utils    _retriev 1690] My profile id: 07BDD45E-0006-0000-0000-000000000000
16:11:04 DEB [utils    _retriev 1698] Retrieving UUID (testId)...
16:11:04 DEB [utils    get_my_u 2272] Attempting to fetch own UUID (testId) from header/dna API...
16:11:04 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/dna (Timeout: 60s, AllowRedirects: True)
16:11:04 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:04 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:04 DEB [utils    _api_req 3219] [Get UUID API] Cookies synced (Attempt 1).
16:11:04 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.558s (CurrentDelay: 0.50s)
16:11:05 DEB [utils    _api_req 3244] [Get UUID API] Rate limit wait: 0.56s (Attempt 1)
16:11:05 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get UUID API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-e1b19ca...4d-01', 'tracestate': '2611750@nr...64524', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:05 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get UUID API'] >>> Calling requests.request...
16:11:05 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get UUID API'] <<< requests.request returned.
16:11:05 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:05 DEB [utils    get_my_u 2286] Successfully retrieved UUID: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:11:05 INF [utils    _retriev 1704] My uuid: FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7
16:11:05 DEB [utils    _retriev 1712] Retrieving tree ID for tree name: 'Gault Family'...
16:11:05 DEB [utils    get_my_t 2327] Attempting to fetch tree ID for TREE_NAME='Gault Family'...
16:11:05 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/header/trees (Timeout: 60s, AllowRedirects: True)
16:11:05 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:05 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:05 DEB [utils    _api_req 3219] [Header Trees API] Cookies synced (Attempt 1).
16:11:05 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.553s (CurrentDelay: 0.50s)
16:11:06 DEB [utils    _api_req 3244] [Header Trees API] Rate limit wait: 0.55s (Attempt 1)
16:11:06 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Header Trees API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-b5646cd...82-01', 'tracestate': '2611750@nr...65679', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:06 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Header Trees API'] >>> Calling requests.request...
16:11:06 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Header Trees API'] <<< requests.request returned.
16:11:06 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:06 DEB [utils    get_my_t 2358] Found tree ID '175946702' for tree 'Gault Family'.
16:11:06 INF [utils    _retriev 1724] My tree id: 175946702
16:11:06 DEB [utils    _retriev 1734] TRACE: Exiting _retrieve_identifiers (Overall success: True)
16:11:06 DEB [utils    _retriev 1743] TRACE: Entered _retrieve_tree_owner
16:11:06 DEB [utils    _retriev 1759] Retrieving tree owner name...
16:11:06 DEB [utils    get_tree 2415] Attempting to fetch tree owner name for tree ID: 175946702...
16:11:06 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/api/uhome/secure/rest/user/tree-info?tree_id=175946702 (Timeout: 60s, AllowRedirects: True)
16:11:06 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:06 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:06 DEB [utils    _api_req 3219] [Tree Owner Name API] Cookies synced (Attempt 1).
16:11:06 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.535s (CurrentDelay: 0.50s)
16:11:07 DEB [utils    _api_req 3244] [Tree Owner Name API] Rate limit wait: 0.54s (Attempt 1)
16:11:07 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Tree Owner Name API'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'Browser:meexp-uhome', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-ae2e550...4a-01', 'tracestate': '2611750@nr...66661', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:07 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Tree Owner Name API'] >>> Calling requests.request...
16:11:07 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Tree Owner Name API'] <<< requests.request returned.
16:11:07 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:07 DEB [utils    get_tree 2432] Found tree owner 'Wayne Gault' for tree ID 175946702.
16:11:07 INF [utils    _retriev 1771] Tree owner name: Wayne Gault
16:11:07 DEB [utils    _retriev 1774] TRACE: Exiting _retrieve_tree_owner (success)
16:11:07 DEB [utils    ensure_s 1226] Identifiers after fetch: profile_id=07BDD45E-0006-0000-0000-000000000000, uuid=FB609BA5-5A0D-46EE-BF18-C300D8DE5AB7, tree_id=175946702
16:11:07 DEB [utils    ensure_s 1229] Tree owner name after fetch: Wayne Gault
16:11:07 DEB [utils    ensure_s 1240] TRACE: Set self.session_ready to: True (ChecksOK: True, IDsOK: True, OwnerOK: True)
16:11:07 DEB [utils    ensure_s 1243] TRACE: Exiting ensure_session_ready (returning True)
16:11:07 INF [api_util _run_tes 816 ] [ PASS   SC ] SessionManager.ensure_session_ready()
16:11:07 INF [api_util self_che 915 ] --- Phase 2: Get Target Info & Validate Config ---
16:11:07 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Tree ID Found
16:11:07 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Tree ID Found
16:11:07 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Owner Name Found
16:11:07 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Owner Name Found
16:11:07 DEB [api_util _run_tes 765 ] [ RUNNING SC ] API Call: Get Target Name
16:11:07 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:11:07 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:07 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:07 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:11:07 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.437s (CurrentDelay: 0.50s)
16:11:08 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.44s (Attempt 1)
16:11:08 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-48516a2...4c-01', 'tracestate': '2611750@nr...67818', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:08 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:11:08 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:11:08 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:08 INF [api_util _run_tes 816 ] [ PASS   SC ] API Call: Get Target Name
16:11:08 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/app-api/express/v1/profiles/details?userId=08FA6E79-0006-0000-0000-000000000000 (Timeout: 60s, AllowRedirects: True)
16:11:08 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:08 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:08 DEB [utils    _api_req 3219] [Get Target Name (Profile Details)] Cookies synced (Attempt 1).
16:11:08 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.596s (CurrentDelay: 0.50s)
16:11:09 DEB [utils    _api_req 3244] [Get Target Name (Profile Details)] Rate limit wait: 0.60s (Attempt 1)
16:11:09 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Target Name (Profile Details)'] Sending Headers: {'Accept': 'application/json, text/plain, */*', 'Referer': 'https://www.ancestry.co.uk/', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'ancestry-clientpath': 'express-fe', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-40b3dc0...89-01', 'tracestate': '2611750@nr...68685', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:09 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Target Name (Profile Details)'] >>> Calling requests.request...
16:11:09 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Target Name (Profile Details)'] <<< requests.request returned.
16:11:09 DEB [utils    _api_req 3294] <-- Response Status: 200 
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Check Target Name Found in API Resp
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] Check Target Name Found in API Resp
16:11:09 INF [api_util self_che 978 ] --- Phase 3: Test parse_ancestry_person_details ---
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: parse_ancestry_person_details()
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: parse_ancestry_person_details()
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Validation: Parsed Details Keys
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] Validation: Parsed Details Keys
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Validation: Parsed Name Match
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] Validation: Parsed Name Match
16:11:09 INF [api_util self_che 1058] --- Phase 4: Test HTML Extraction ---
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Good JSONP
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Good JSONP
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Bad JSON in JSONP
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Bad JSON in JSONP
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: No HTML Key in JSONP
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: No HTML Key in JSONP
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Good Direct JSON
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Good Direct JSON
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Bad Direct JSON
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Bad Direct JSON
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] HTML Extract: Invalid Input
16:11:09 INF [api_util _run_tes 816 ] [ PASS   SC ] HTML Extract: Invalid Input
16:11:09 INF [api_util self_che 1118] --- Phase 5: Test Relationship Ladder Parsing (Live API) ---
16:11:09 DEB [api_util _run_tes 765 ] [ RUNNING SC ] API Call: Get Tree Ladder
16:11:09 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:11:09 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198669802&_=1746198669802 (Timeout: 20s, AllowRedirects: True)
16:11:09 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:09 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:09 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:11:09 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.445s (CurrentDelay: 0.50s)
16:11:10 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.45s (Attempt 1)
16:11:10 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-fa5ba32...ae-01', 'tracestate': '2611750@nr...69820', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:10 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:11:11 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:11:11 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:11:11 INF [api_util _run_tes 816 ] [ PASS   SC ] API Call: Get Tree Ladder
16:11:11 DEB [utils    _api_req 3164] [Get Tree Ladder API (Self Check)] Applied 2 explicit header overrides.
16:11:11 DEB [utils    _api_req 3180] API Req: GET https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/getladder?callback=__ancestry_jsonp_1746198669802&_=1746198669802 (Timeout: 20s, AllowRedirects: True)
16:11:11 DEB [utils    _sync_co 1937] Retrieved 42 cookies from WebDriver for sync.
16:11:11 DEB [utils    _sync_co 2010] Successfully synced 42 cookies to requests session.
16:11:11 DEB [utils    _api_req 3219] [Get Tree Ladder API (Self Check)] Cookies synced (Attempt 1).
16:11:11 DEB [utils    wait     842 ] Token available (9.00 left). Applying base delay: 0.568s (CurrentDelay: 0.50s)
16:11:11 DEB [utils    _api_req 3244] [Get Tree Ladder API (Self Check)] Rate limit wait: 0.57s (Attempt 1)
16:11:11 DEB [utils    _api_req 3265] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] Sending Headers: {'Accept': 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01', 'Referer': 'https://www.ancestry.co.uk/family-tree/person/tree/175946702/person/102281560544/facts', 'Cache-Control': 'no-cache', 'Pragma': 'no-cache', '_method': 'GET', 'X-Requested-With': 'XMLHttpRequest', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36', 'newrelic': 'eyJ2IjpbMC...wIn19', 'traceparent': '00-363e1c1...42-01', 'tracestate': '2611750@nr...71039', 'ancestry-context-ube': 'eyJldmVudE...7fSJ9', 'ancestry-userid': '07BDD45E-0006-0000-0000-000000000000'}
16:11:11 DEB [utils    _api_req 3274] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] >>> Calling requests.request...
16:11:12 DEB [utils    _api_req 3288] [_api_req Attempt 1 'Get Tree Ladder API (Self Check)'] <<< requests.request returned.
16:11:12 DEB [utils    _api_req 3294] <-- Response Status: 200 OK
16:11:12 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: display_raw_relationship_ladder()
16:11:12 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: display_raw_relationship_ladder()
16:11:12 DEB [api_util _run_tes 765 ] [ RUNNING SC ] Function Call: format_api_relationship_path()
16:11:12 INF [api_util _run_tes 816 ] [ PASS   SC ] Function Call: format_api_relationship_path()
16:11:12 INF [api_util self_che 1263] --- Finalizing: Closing Session ---
16:11:12 DEB [utils    close_se 2732] Attempting to close WebDriver session...
16:11:12 DEB [utils    close_se 2735] WebDriver session quit successfully.
16:11:12 DEB [utils    close_se 2754] Closing database connection pool...
16:11:12 DEB [utils    cls_db_c 2185] SessionManager ID=117731936 cls_db_conn called (keep_db=False). Disposing Engine ID: 115414208
16:11:12 DEB [utils    cls_db_c 2190] Engine ID=115414208 disposed successfully.
16:11:12 INF [api_util self_che 1300] api_utils self-check overall status: PASS
16:11:12 DEB [cache    close_ca 261 ] Closing DiskCache connection...
16:11:12 DEB [cache    close_ca 263 ] DiskCache connection closed.
